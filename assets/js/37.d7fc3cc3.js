(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{412:function(t,e,n){"use strict";n.r(e);var a=n(43),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"_126"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_126"}},[t._v("#")]),t._v(" 126")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("  BIP: 126\n  Title: Best Practices for Heterogeneous Input Script Transactions\n  Author: Kristov Atlas <kristov@openbitcoinprivacyproject.org>\n  Comments-Summary: No comments yet.\n  Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-0126\n  Status: Draft\n  Type: Informational\n  Created: 2016-02-10\n  License: PD\n")])])]),n("h2",{attrs:{id:"abstract"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[t._v("#")]),t._v(" Abstract")]),t._v(" "),n("p",[t._v("When a Bitcoin transaction contains inputs that reference previous\ntransaction outputs sent to different Bitcoin addresses, personally\nidentifiable information of the user will leak into the blockchain in an\nuncontrolled manner. While undesirable, these transactions are\nfrequently unavoidable due to the natural fragmentation of wallet\nbalances over time.")]),t._v(" "),n("p",[t._v("This document proposes a set of best practice guidelines which minimize\nthe uncontrolled disclosure of personally identifiable information by\ndefining standard forms for transactions containing heterogenous input\nscripts.")]),t._v(" "),n("h2",{attrs:{id:"copyright"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[t._v("#")]),t._v(" Copyright")]),t._v(" "),n("p",[t._v("This BIP is in the public domain.")]),t._v(" "),n("h2",{attrs:{id:"definitions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#definitions"}},[t._v("#")]),t._v(" Definitions")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("Heterogenous input script transaction (HIT)")]),t._v(": A transaction\ncontaining multiple inputs where the scripts of the previous\ntransaction outputs being consumed are not identical (e.g. a\ntransaction spending outputs which were sent to more than one\nBitcoin address)")]),t._v(" "),n("li",[n("strong",[t._v("Unavoidable heterogenous input script transaction")]),t._v(": A HIT created\nas a result of a user's desire to create a new output with a value\nlarger than the value of his wallet's largest existing unspent\noutput")]),t._v(" "),n("li",[n("strong",[t._v("Intentional heterogenous input script transaction")]),t._v(": A HIT created\nas part of a user protection protocol for reducing uncontrolled\ndisclosure of personally-identifying information (PII)")])]),t._v(" "),n("p",[t._v('Throughout this procedure, when input scripts are evaluated for\nuniqueness, "input script" should be interpreted to mean, "the script\nof the previous output referenced by an input to a transaction".')]),t._v(" "),n("h2",{attrs:{id:"motivations"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#motivations"}},[t._v("#")]),t._v(" Motivations")]),t._v(" "),n("p",[t._v("The recommendations in this document are designed to accomplish three\ngoals:")]),t._v(" "),n("ol",[n("li",[t._v("Maximise the effectiveness of user-protecting protocols: Users may\nfind that protection protocols are counterproductive if such\ntransactions have a distinctive fingerprint which renders them\nineffective.")]),t._v(" "),n("li",[t._v("Minimise the adverse consequences of unavoidable heterogenous input\ntransactions: If unavoidable HITs are indistinguishable from\nintentional HITs, a user creating an unavoidable HIT benefits from\nambiguity with respect to graph analysis.")]),t._v(" "),n("li",[t._v("Limiting the effect on UTXO set growth: To date, non-standardized\nintentional HITs tend to increase the network's UTXO set with each\ntransaction; this standard attempts to minimize this effect by\nstandardizing unavoidable and intentional HITs to limit UTXO set\ngrowth.")])]),t._v(" "),n("p",[t._v("In order to achieve these goals, this specification proposes a set of\nbest practices for heterogenous input script transaction creation. These\npractices accommodate all applicable requirements of both intentional\nand unavoidable HITs while maximising the effectiveness of both in terms\nof preventing uncontrolled disclosure of PII.")]),t._v(" "),n("p",[t._v("In order to achieve this, two forms of HIT are proposed: Standard form\nand alternate form.")]),t._v(" "),n("h2",{attrs:{id:"interaction-with-other-procedures-interaction-with-other-procedures"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#interaction-with-other-procedures-interaction-with-other-procedures"}},[t._v("#")]),t._v(" Interaction with Other Procedures {#interaction_with_other_procedures}")]),t._v(" "),n("p",[t._v("Applications which wish to comply both with this procedure and BIP69\nshould apply this procedure prior to applying BIP69.")]),t._v(" "),n("h2",{attrs:{id:"standard-form-heterogenous-input-script-transaction-standard-form-heterogenous-input-script-transaction"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#standard-form-heterogenous-input-script-transaction-standard-form-heterogenous-input-script-transaction"}},[t._v("#")]),t._v(" Standard form heterogenous input script transaction {#standard_form_heterogenous_input_script_transaction}")]),t._v(" "),n("h3",{attrs:{id:"rules"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rules"}},[t._v("#")]),t._v(" Rules")]),t._v(" "),n("p",[t._v("A HIT is Standard form if it adheres to all of the following rules:")]),t._v(" "),n("ol",[n("li",[t._v("The number of unique output scripts must be equal to the number of\nunique inputs scripts (irrespective of the number of inputs and\noutputs).")]),t._v(" "),n("li",[t._v("All output scripts must be unique.")]),t._v(" "),n("li",[t._v("At least one pair of outputs must be of equal value.")]),t._v(" "),n("li",[t._v("The largest output in the transaction is a member of a set\ncontaining at least two identically-sized outputs.")])]),t._v(" "),n("h3",{attrs:{id:"rationale"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rationale"}},[t._v("#")]),t._v(" Rationale")]),t._v(" "),n("p",[t._v("The requirement for equal numbers of unique input/output scripts instead\nof equal number of inputs/outputs accommodates user-protecting UTXO\nselection behavior. Wallets may contain spendable outputs with identical\nscripts due to intentional or accidental address reuse, or due to\ndusting attacks. In order to minimise the adverse consequences of\naddress reuse, any time a UTXO is included in a transaction as an input,\nall UTXOs with the same spending script should also be included in the\ntransaction.")]),t._v(" "),n("p",[t._v("The requirement that all output scripts are unique prevents address\nreuse. Restricting the number of outputs to the number of unique input\nscripts prevents this policy from growing the network's UTXO set. A\nstandard form HIT transaction will always have a number of inputs\ngreater than or equal to the number of outputs.")]),t._v(" "),n("p",[t._v("The requirement for at least one pair of outputs in an intentional HIT\nto be of equal value results in optimal behavior, and causes intentional\nHITs to resemble unavoidable HITs.")]),t._v(" "),n("h2",{attrs:{id:"alternate-form-heterogenous-input-script-transactions-alternate-form-heterogenous-input-script-transactions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#alternate-form-heterogenous-input-script-transactions-alternate-form-heterogenous-input-script-transactions"}},[t._v("#")]),t._v(" Alternate form heterogenous input script transactions {#alternate_form_heterogenous_input_script_transactions}")]),t._v(" "),n("p",[t._v("The formation of a standard form HIT is not possible in the following\ncases:")]),t._v(" "),n("ol",[n("li",[t._v("The HIT is unavoidable, and the user's wallet contains an\ninsufficient number or size of UTXOs to create a standard form HIT.")]),t._v(" "),n("li",[t._v("The user wishes to reduce the number of utxos in their wallet, and\ndoes not have any sets of utxos with identical scripts.")])]),t._v(" "),n("p",[t._v("When one of the following cases exist, a compliant implementation may\ncreate an alternate form HIT by constructing a transaction as follows:")]),t._v(" "),n("h3",{attrs:{id:"procedure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#procedure"}},[t._v("#")]),t._v(" Procedure")]),t._v(" "),n("ol",[n("li",[t._v("Find the smallest combination of inputs whose value is at least the\nvalue of the desired spend.\n"),n("ol",[n("li",[t._v("Add these inputs to the transaction.")]),t._v(" "),n("li",[t._v("Add a spend output to the transaction.")]),t._v(" "),n("li",[t._v("Add a change output to the transaction containing the difference\nbetween the current set of inputs and the desired spend.")])])]),t._v(" "),n("li",[t._v("Repeat step 1 to create a second pair of outputs, where one output\nhas the same value as the spend output of the previous step.")]),t._v(" "),n("li",[t._v("(optional) Repeat step 2 until the desired number of inputs have\nbeen consumed and/or the desired number outputs have been created.")]),t._v(" "),n("li",[t._v("Adjust the change outputs as necessary to pay the desired\ntransaction fee.")])]),t._v(" "),n("p",[t._v("Clients which create intentional HITs must have the capability to form\nalternate form HITs, and must do so for a non-zero fraction of the\ntransactions they create.")]),t._v(" "),n("h3",{attrs:{id:"rules-rules-1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rules-rules-1"}},[t._v("#")]),t._v(" Rules {#rules_1}")]),t._v(" "),n("p",[t._v("An HIT formed via the preceding procedure will adhere to the following\nconditions:")]),t._v(" "),n("ol",[n("li",[t._v("The number of unique inputs scripts must exceed the number of output\nscripts.")]),t._v(" "),n("li",[t._v("All output scripts must be unique.")]),t._v(" "),n("li",[t._v("At least one pair of outputs must be of equal value.\n"),n("ol",[n("li",[t._v('"Standard outputs" refers to the set of outputs with equal\nvalue')]),t._v(" "),n("li",[t._v('"Standard value" refers to the value of the standard outputs')]),t._v(" "),n("li",[t._v('"Change outputs" refers to all outputs which are not standard\noutputs')])])]),t._v(" "),n("li",[t._v("For a HIT containing n standard outputs, there must exist at least\none possible way to organize the inputs and outputs into n sets,\nwhere all sets satisfy the following:\n"),n("ol",[n("li",[t._v("The set contains one or more inputs, exactly one standard\noutput, and exactly one change output")]),t._v(" "),n("li",[t._v("An input or output that appears in one set must not appear in\nany other set")]),t._v(" "),n("li",[t._v("The sum of the inputs in the set minus the value of the change\noutput is equal to the standard value with a tolerance equal to\nthe transaction fee.")]),t._v(" "),n("li",[t._v("Change outputs with a value of zero (virtual change outputs) are\npermitted. The are defined for the purpose of testing whether or\nnot a HIT adheres to this specification but are not present in\nthe version of the transaction which is broadcast to the\nnetwork.")])])])]),t._v(" "),n("h2",{attrs:{id:"non-compliant-heterogenous-input-script-transactions-non-compliant-heterogenous-input-script-transactions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#non-compliant-heterogenous-input-script-transactions-non-compliant-heterogenous-input-script-transactions"}},[t._v("#")]),t._v(" Non-compliant heterogenous input script transactions {#non_compliant_heterogenous_input_script_transactions}")]),t._v(" "),n("p",[t._v("If a user wishes to create an output that is larger than half the total\nsize of their spendable outputs, or if their inputs are not distributed\nin a manner in which the alternate form procedure can be completed, then\nthe user can not create a transaction which is compliant with this\nprocedure.")]),t._v(" "),n("h2",{attrs:{id:"reference"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[t._v("#")]),t._v(" Reference")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"bip-0069.mediawiki",title:"wikilink"}},[t._v("BIP69 - Lexicographical Indexing of Transaction Inputs and\nOutputs")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);