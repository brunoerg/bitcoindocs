(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{416:function(e,t,a){"use strict";a.r(t);var n=a(43),i=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"_133"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_133"}},[e._v("#")]),e._v(" 133")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("  BIP: 133\n  Layer: Peer Services\n  Title: feefilter message\n  Author: Alex Morcos <morcos@chaincode.com>\n  Comments-Summary: No comments yet.\n  Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-0133\n  Status: Draft\n  Type: Standards Track\n  Created: 2016-02-13\n  License: PD\n")])])]),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),a("p",[e._v('Add a new message, "feefilter", which serves to instruct peers not to\nsend "inv"\'s to the node for transactions with fees below the\nspecified fee rate.')]),e._v(" "),a("h2",{attrs:{id:"motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[e._v("#")]),e._v(" Motivation")]),e._v(" "),a("p",[e._v("The concept of a limited mempool was introduced in Bitcoin Core 0.12 to\nprovide protection against attacks or spam transactions of low fees that\nare not being mined. A reject filter was also introduced to help prevent\nrepeated requests for the same transaction that might have been recently\nrejected for insufficient fee. These methods help keep resource\nutilization on a node from getting out of control.")]),e._v(" "),a("p",[e._v("However, there are limitations to the effectiveness of these approaches.\nThe reject filter is reset after every block which means transactions\nthat are inv'ed over a longer time period will be rerequested and there\nis no method to prevent requesting the transaction the first time.\nFurthermore, inv data is sent at least once either to or from each peer\nfor every transaction accepted to the mempool and there is no mechanism\nby which to know that an inv sent to a given peer would not result in a\ngetdata request because it represents a transaction with too little fee.")]),e._v(" "),a("p",[e._v("After receiving a feefilter message, a node can know before sending an\ninv that a given transaction's fee rate is below the minimum currently\nrequired by a given peer, and therefore the node can skip relaying an\ninv for that transaction to that peer.")]),e._v(" "),a("h2",{attrs:{id:"specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[e._v("#")]),e._v(" Specification")]),e._v(" "),a("ol",[a("li",[e._v('The feefilter message is defined as a message containing an int64_t\nwhere pchCommand == "feefilter"')]),e._v(" "),a("li",[e._v('Upon receipt of a "feefilter" message, the node will be permitted,\nbut not required, to filter transaction invs for transactions that\nfall below the feerate provided in the feefilter message interpreted\nas satoshis per kilobyte.')]),e._v(" "),a("li",[e._v("The fee filter is additive with a bloom filter for transactions so\nif an SPV client were to load a bloom filter and send a feefilter\nmessage, transactions would only be relayed if they passed both\nfilters.")]),e._v(" "),a("li",[e._v("Inv's generated from a mempool message are also subject to a fee\nfilter if it exists.")]),e._v(" "),a("li",[e._v("Feature discovery is enabled by checking protocol version >= 70013")])]),e._v(" "),a("h2",{attrs:{id:"considerations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#considerations"}},[e._v("#")]),e._v(" Considerations")]),e._v(" "),a("p",[e._v("The propagation efficiency of transactions across the network should not\nbe adversely affected by this change. In general, transactions which are\nnot accepted to a node's mempool are not relayed by this node and the\nfunctionality implemented with this message is meant only to filter\nthose transactions. There could be a small number of edge cases where a\nnode's mempool min fee is actually less than the filter value a peer is\naware of and transactions with fee rates between these values will now\nbe newly inhibited.")]),e._v(" "),a("p",[e._v('Feefilter messages are not sent to whitelisted peers if the\n"-whitelistforcerelay" option is set. In that case, transactions are\nintended to be relayed even if they are not accepted to the mempool.')]),e._v(" "),a("p",[e._v("There are privacy concerns with deanonymizing a node by the fact that it\nis broadcasting identifying information about its mempool min fee. To\nhelp ameliorate this concern, the implementation quantizes the filter\nvalue broadcast with a small amount of randomness, in addition, the\nmessages are broadcast to different peers at individually randomly\ndistributed times.")]),e._v(" "),a("p",[e._v("If a node is using prioritisetransaction to accept transactions whose\nactual fee rates might fall below the node's mempool min fee, it may\nwant to consider disabling the fee filter to make sure it is exposed to\nall possible txid's.")]),e._v(" "),a("h2",{attrs:{id:"backward-compatibility-backward-compatibility"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backward-compatibility-backward-compatibility"}},[e._v("#")]),e._v(" Backward compatibility {#backward_compatibility}")]),e._v(" "),a("p",[e._v("Older clients remain fully compatible and interoperable after this\nchange. Also, clients implementing this BIP can choose to not send any\nfeefilter messages.")]),e._v(" "),a("h2",{attrs:{id:"implementation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#implementation"}},[e._v("#")]),e._v(" Implementation")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/bitcoin/bitcoin/pull/7542",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/bitcoin/bitcoin/pull/7542"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"copyright"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[e._v("#")]),e._v(" Copyright")]),e._v(" "),a("p",[e._v("This document is placed in the public domain.")])])}),[],!1,null,null,null);t.default=i.exports}}]);