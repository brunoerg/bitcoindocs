(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{476:function(e,t,a){"use strict";a.r(t);var i=a(43),s=Object(i.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"_67"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_67"}},[e._v("#")]),e._v(" 67")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("  BIP: 67\n  Layer: Applications\n  Title: Deterministic Pay-to-script-hash multi-signature addresses through public key sorting\n  Author: Thomas Kerin <me@thomaskerin.io>\n          Jean-Pierre Rupp <root@haskoin.com>\n          Ruben de Vries <ruben@rubensayshi.com>\n  Comments-Summary: No comments yet.\n  Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-0067\n  Status: Proposed\n  Type: Standards Track\n  Created: 2015-02-08\n  License: PD\n")])])]),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),a("p",[e._v("This BIP describes a method to deterministically generate\nmulti-signature pay-to-script-hash transaction scripts. It focuses on\ndefining how the public keys must be encoded and sorted so that the\nredeem script and corresponding P2SH address are always the same for a\ngiven set of keys and number of required signatures.")]),e._v(" "),a("h2",{attrs:{id:"motivation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[e._v("#")]),e._v(" Motivation")]),e._v(" "),a("p",[e._v("Pay-to-script-hash (BIP-0011"),a("a",{attrs:{href:"%5BBIP-0011%5D(https://github.com/bitcoin/bips/blob/master/bip-0011.mediawiki)"}},[e._v("^1")]),e._v(") is a transaction type that allows\nfunding of arbitrary scripts, where the recipient carries the cost of\nfee's associated with using longer, more complex scripts.")]),e._v(" "),a("p",[e._v("Multi-signature pay-to-script-hash transactions are defined in\nBIP-0016"),a("a",{attrs:{href:"%5BBIP-0016%5D(https://github.com/bitcoin/bips/blob/master/bip-0016.mediawiki)"}},[e._v("^2")]),e._v('. The redeem script does not require a particular ordering\nor encoding for public keys. This means that for a given set of keys and\nnumber of required signatures, there are as many as 2(n!) possible\nstandard redeem scripts, each with its separate P2SH address. Adhering\nto an ordering and key encoding would ensure that a multi-signature\n"account" (set of public keys and required signature count) has a\ncanonical P2SH address.')]),e._v(" "),a("p",[e._v("By adopting a sorting and encoding standard, compliant wallets will\nalways produce the same P2SH address for the same given set of keys and\nrequired signature count, making it easier to recognize transactions\ninvolving that multi-signature account. This is particularly attractive\nfor multisignature hierarchical-deterministic wallets, as less state is\nrequired to setup multi-signature accounts: only the number of required\nsignatures and master public keys of participants need to be shared, and\nall wallets will generate the same addresses.")]),e._v(" "),a("p",[e._v("While most web wallets do not presently facilitate the setup of\nmultisignature accounts with users of a different service, conventions\nwhich ensure cross-compatibility should make it easier to achieve this.")]),e._v(" "),a("p",[e._v("Many wallet as a service providers use a 2of3 multi-signature schema\nwhere the user stores 1 of the keys (offline) as backup while using the\nother key for daily use and letting the service cosign his transactions.\nThis standard will help in enabling a party other than the service\nprovider to recover the wallet without any help from the service\nprovider.")]),e._v(" "),a("h2",{attrs:{id:"specification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[e._v("#")]),e._v(" Specification")]),e._v(" "),a("p",[e._v("For a set of public keys, ensure that they have been received in\ncompressed form:")]),e._v(" "),a("p",[a("code",[e._v("022df8750480ad5b26950b25c7ba79d3e37d75f640f8e5d9bcd5b150a0f85014da")]),a("br"),e._v(" "),a("code",[e._v("03e3818b65bcc73a7d64064106a859cc1a5a728c4345ff0b641209fba0d90de6e9")]),a("br"),e._v(" "),a("code",[e._v("021f2f6e1e50cb6a953935c3601284925decd3fd21bc445712576873fb8c6ebc18")]),e._v("\\")]),e._v(" "),a("p",[e._v("Sort them lexicographically according to their binary representation:")]),e._v(" "),a("p",[a("code",[e._v("021f2f6e1e50cb6a953935c3601284925decd3fd21bc445712576873fb8c6ebc18")]),a("br"),e._v(" "),a("code",[e._v("022df8750480ad5b26950b25c7ba79d3e37d75f640f8e5d9bcd5b150a0f85014da")]),a("br"),e._v(" "),a("code",[e._v("03e3818b65bcc73a7d64064106a859cc1a5a728c4345ff0b641209fba0d90de6e9")])]),e._v(" "),a("p",[e._v("..before using the resulting list of keys in a standard multisig redeem\nscript:")]),e._v(" "),a("p",[a("code",[e._v("OP_2 021f2f6e1e50cb6a953935c3601284925decd3fd21bc445712576873fb8c6ebc18 022df8750480ad5b26950b25c7ba79d3e37d75f640f8e5d9bcd5b150a0f85014da 03e3818b65bcc73a7d64064106a859cc1a5a728c4345ff0b641209fba0d90de6e9 OP_3 OP_CHECKMULTISIG")])]),e._v(" "),a("p",[e._v("Hash the redeem script according to BIP-0016 to get the P2SH address.")]),e._v(" "),a("p",[a("code",[e._v("3Q4sF6tv9wsdqu2NtARzNCpQgwifm2rAba")]),a("br"),e._v(" "),a("code")]),e._v(" "),a("h2",{attrs:{id:"compatibility"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compatibility"}},[e._v("#")]),e._v(" Compatibility")]),e._v(" "),a("ul",[a("li",[e._v("Uncompressed keys are incompatible with this specificiation. A\ncompatible implementation should not automatically compress keys.\nReceiving an uncompressed key from a multisig participant should be\ninterpreted as a sign that the user has an incompatible\nimplementation.")]),e._v(" "),a("li",[e._v("P2SH addressses do not reveal information about the script that is\nreceiving the funds. For this reason it is not technically possible\nto enforce this BIP as a rule on the network. Also, it would cause a\nhard fork.")]),e._v(" "),a("li",[e._v("Implementations that do not conform with this BIP will have\ncompatibility issues with strictly-compliant wallets.")]),e._v(" "),a("li",[e._v("Implementations which do adopt this standard will be\ncross-compatible when choosing multisig addressses.")]),e._v(" "),a("li",[e._v("If a group of users were not entirely compliant, there is the\npossibility that a participant will derive an address that the\nothers will not recognize as part of the common multisig account.")])]),e._v(" "),a("h2",{attrs:{id:"test-vectors-test-vectors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-vectors-test-vectors"}},[e._v("#")]),e._v(" Test vectors {#test_vectors}")]),e._v(" "),a("p",[e._v("Two signatures are required in each of these test vectors.")]),e._v(" "),a("p",[e._v("Vector 1")]),e._v(" "),a("ul",[a("li",[e._v("List\n"),a("ul",[a("li",[e._v("02ff12471208c14bd580709cb2358d98975247d8765f92bc25eab3b2763ed605f8")]),e._v(" "),a("li",[e._v("02fe6f0a5a297eb38c391581c4413e084773ea23954d93f7753db7dc0adc188b2f")])])]),e._v(" "),a("li",[e._v("Sorted\n"),a("ul",[a("li",[e._v("02fe6f0a5a297eb38c391581c4413e084773ea23954d93f7753db7dc0adc188b2f")]),e._v(" "),a("li",[e._v("02ff12471208c14bd580709cb2358d98975247d8765f92bc25eab3b2763ed605f8")])])]),e._v(" "),a("li",[e._v("Script\n"),a("ul",[a("li",[e._v("522102fe6f0a5a297eb38c391581c4413e084773ea23954d93f7753db7dc0adc188b2f2102ff12471208c14bd580709cb2358d98975247d8765f92bc25eab3b2763ed605f852ae")])])]),e._v(" "),a("li",[e._v("Address\n"),a("ul",[a("li",[e._v("39bgKC7RFbpoCRbtD5KEdkYKtNyhpsNa3Z")])])])]),e._v(" "),a("p",[e._v("Vector 2 (Already sorted, no action required)")]),e._v(" "),a("ul",[a("li",[e._v("List:\n"),a("ul",[a("li",[e._v("02632b12f4ac5b1d1b72b2a3b508c19172de44f6f46bcee50ba33f3f9291e47ed0")]),e._v(" "),a("li",[e._v("027735a29bae7780a9755fae7a1c4374c656ac6a69ea9f3697fda61bb99a4f3e77")]),e._v(" "),a("li",[e._v("02e2cc6bd5f45edd43bebe7cb9b675f0ce9ed3efe613b177588290ad188d11b404")])])]),e._v(" "),a("li",[e._v("Sorted:\n"),a("ul",[a("li",[e._v("02632b12f4ac5b1d1b72b2a3b508c19172de44f6f46bcee50ba33f3f9291e47ed0")]),e._v(" "),a("li",[e._v("027735a29bae7780a9755fae7a1c4374c656ac6a69ea9f3697fda61bb99a4f3e77")]),e._v(" "),a("li",[e._v("02e2cc6bd5f45edd43bebe7cb9b675f0ce9ed3efe613b177588290ad188d11b404")])])]),e._v(" "),a("li",[e._v("Script\n"),a("ul",[a("li",[e._v("522102632b12f4ac5b1d1b72b2a3b508c19172de44f6f46bcee50ba33f3f9291e47ed021027735a29bae7780a9755fae7a1c4374c656ac6a69ea9f3697fda61bb99a4f3e772102e2cc6bd5f45edd43bebe7cb9b675f0ce9ed3efe613b177588290ad188d11b40453ae")])])]),e._v(" "),a("li",[e._v("Address\n"),a("ul",[a("li",[e._v("3CKHTjBKxCARLzwABMu9yD85kvtm7WnMfH")])])])]),e._v(" "),a("p",[e._v("Vector 3:")]),e._v(" "),a("ul",[a("li",[e._v("List:\n"),a("ul",[a("li",[e._v("030000000000000000000000000000000000004141414141414141414141414141")]),e._v(" "),a("li",[e._v("020000000000000000000000000000000000004141414141414141414141414141")]),e._v(" "),a("li",[e._v("020000000000000000000000000000000000004141414141414141414141414140")]),e._v(" "),a("li",[e._v("030000000000000000000000000000000000004141414141414141414141414140")])])]),e._v(" "),a("li",[e._v("Sorted:\n"),a("ul",[a("li",[e._v("020000000000000000000000000000000000004141414141414141414141414140")]),e._v(" "),a("li",[e._v("020000000000000000000000000000000000004141414141414141414141414141")]),e._v(" "),a("li",[e._v("030000000000000000000000000000000000004141414141414141414141414140")]),e._v(" "),a("li",[e._v("030000000000000000000000000000000000004141414141414141414141414141")])])]),e._v(" "),a("li",[e._v("Script\n"),a("ul",[a("li",[e._v("522102000000000000000000000000000000000000414141414141414141414141414021020000000000000000000000000000000000004141414141414141414141414141210300000000000000000000000000000000000041414141414141414141414141402103000000000000000000000000000000000000414141414141414141414141414154ae")])])]),e._v(" "),a("li",[e._v("Address\n"),a("ul",[a("li",[e._v("32V85igBri9zcfBRVupVvwK18NFtS37FuD")])])])]),e._v(" "),a("p",[e._v("Vector 4: (from bitcore)")]),e._v(" "),a("ul",[a("li",[e._v("List:\n"),a("ul",[a("li",[e._v("022df8750480ad5b26950b25c7ba79d3e37d75f640f8e5d9bcd5b150a0f85014da")]),e._v(" "),a("li",[e._v("03e3818b65bcc73a7d64064106a859cc1a5a728c4345ff0b641209fba0d90de6e9")]),e._v(" "),a("li",[e._v("021f2f6e1e50cb6a953935c3601284925decd3fd21bc445712576873fb8c6ebc18")])])]),e._v(" "),a("li",[e._v("Sorted:\n"),a("ul",[a("li",[e._v("021f2f6e1e50cb6a953935c3601284925decd3fd21bc445712576873fb8c6ebc18")]),e._v(" "),a("li",[e._v("022df8750480ad5b26950b25c7ba79d3e37d75f640f8e5d9bcd5b150a0f85014da")]),e._v(" "),a("li",[e._v("03e3818b65bcc73a7d64064106a859cc1a5a728c4345ff0b641209fba0d90de6e9")])])]),e._v(" "),a("li",[e._v("Script\n"),a("ul",[a("li",[e._v("5221021f2f6e1e50cb6a953935c3601284925decd3fd21bc445712576873fb8c6ebc1821022df8750480ad5b26950b25c7ba79d3e37d75f640f8e5d9bcd5b150a0f85014da2103e3818b65bcc73a7d64064106a859cc1a5a728c4345ff0b641209fba0d90de6e953ae")])])]),e._v(" "),a("li",[e._v("Address\n"),a("ul",[a("li",[e._v("3Q4sF6tv9wsdqu2NtARzNCpQgwifm2rAba")])])])]),e._v(" "),a("h2",{attrs:{id:"acknowledgements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#acknowledgements"}},[e._v("#")]),e._v(" Acknowledgements")]),e._v(" "),a("p",[e._v("The authors wish to thank BtcDrak and Luke-Jr for their involvement &\ncontributions in the early discussions of this BIP.")]),e._v(" "),a("h2",{attrs:{id:"usage-implementations-usage-implementations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usage-implementations-usage-implementations"}},[e._v("#")]),e._v(" Usage & Implementations {#usage_implementations}")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0045.mediawiki#address-generation-procedure",title:"wikilink",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP-0045"),a("OutboundLink")],1),e._v(" -\nStructure for Deterministic P2SH Multisignature Wallets")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/bitpay/bitcore/blob/50a868cb8cdf2be04bb1c5bf4bcc064cc06f5888/lib/script/script.js#L541",title:"wikilink",target:"_blank",rel:"noopener noreferrer"}},[e._v("Bitcore"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/haskoin/haskoin/blob/master/Network/Haskoin/Script/Parser.hs#L112-122",title:"wikilink",target:"_blank",rel:"noopener noreferrer"}},[e._v("Haskoin"),a("OutboundLink")],1),e._v("\nBitcoin implementation in haskell")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/etotheipi/BitcoinArmory/blob/268db0f3fa20c989057bd43343a43b2edbe89aeb/armoryengine/ArmoryUtils.py#L1441",title:"wikilink",target:"_blank",rel:"noopener noreferrer"}},[e._v("Armory"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/bitcoinj/bitcoinj/blob/master/core/src/main/java/org/bitcoinj/script/ScriptBuilder.java#L331",title:"wikilink",target:"_blank",rel:"noopener noreferrer"}},[e._v("BitcoinJ"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"references"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[e._v("#")]),e._v(" References")]),e._v(" "),a("h2",{attrs:{id:"copyright"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[e._v("#")]),e._v(" Copyright")]),e._v(" "),a("p",[e._v("This document is placed in the public domain.")])])}),[],!1,null,null,null);t.default=s.exports}}]);