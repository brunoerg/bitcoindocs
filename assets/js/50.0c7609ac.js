(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{431:function(e,a,c){"use strict";c.r(a);var f=c(43),b=Object(f.a)({},(function(){var e=this,a=e.$createElement,c=e._self._c||a;return c("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[c("h1",{attrs:{id:"_143"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#_143"}},[e._v("#")]),e._v(" 143")]),e._v(" "),c("div",{staticClass:"language- extra-class"},[c("pre",[c("code",[e._v("  BIP: 143\n  Layer: Consensus (soft fork)\n  Title: Transaction Signature Verification for Version 0 Witness Program\n  Author: Johnson Lau <jl2012@xbt.hk>\n          Pieter Wuille <pieter.wuille@gmail.com>\n  Comments-Summary: No comments yet.\n  Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-0143\n  Status: Final\n  Type: Standards Track\n  Created: 2016-01-03\n  License: PD\n")])])]),c("h2",{attrs:{id:"abstract"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),c("p",[e._v("This proposal defines a new transaction digest algorithm for signature\nverification in version 0 witness program, in order to minimize\nredundant data hashing in verification, and to cover the input value by\nthe signature.")]),e._v(" "),c("h2",{attrs:{id:"motivation"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#motivation"}},[e._v("#")]),e._v(" Motivation")]),e._v(" "),c("p",[e._v("There are 4 ECDSA signature verification codes in the original Bitcoin\nscript system: "),c("code",[e._v("CHECKSIG")]),e._v(", "),c("code",[e._v("CHECKSIGVERIFY")]),e._v(", "),c("code",[e._v("CHECKMULTISIG")]),e._v(",\n"),c("code",[e._v("CHECKMULTISIGVERIFY")]),e._v(' ("sigops"). According to the sighash type ('),c("code",[e._v("ALL")]),e._v(",\n"),c("code",[e._v("NONE")]),e._v(", "),c("code",[e._v("SINGLE")]),e._v(", "),c("code",[e._v("ANYONECANPAY")]),e._v("), a transaction digest is generated\nwith a double SHA256 of a serialized subset of the transaction, and the\nsignature is verified against this digest with a given public key. The\ndetailed procedure is described in a Bitcoin Wiki article. "),c("a",{attrs:{href:"%5B1%5D(https://en.bitcoin.it/wiki/OP_CHECKSIG)"}},[e._v("^1")])]),e._v(" "),c("p",[e._v("Unfortunately, there are at least 2 weaknesses in the original\nSignatureHash transaction digest algorithm:")]),e._v(" "),c("ul",[c("li",[e._v('For the verification of each signature, the amount of data hashing\nis proportional to the size of the transaction. Therefore, data\nhashing grows in O(n^2^) as the number of sigops in a transaction\nincreases. While a 1 MB block would normally take 2 seconds to\nverify with an average computer in 2015, a 1MB transaction with 5569\nsigops may take 25 seconds to verify. This could be fixed by\noptimizing the digest algorithm by introducing some reusable\n"midstate", so the time complexity becomes O(n). [^2][^3][^4]')]),e._v(" "),c("li",[e._v('The algorithm does not involve the amount of Bitcoin being spent by\nthe input. This is usually not a problem for online network nodes as\nthey could request for the specified transaction to acquire the\noutput value. For an offline transaction signing device ("cold\nwallet"), however, the unknowing of input amount makes it\nimpossible to calculate the exact amount being spent and the\ntransaction fee. To cope with this problem a cold wallet must also\nacquire the full transaction being spent, which could be a big\nobstacle in the implementation of lightweight, air-gapped wallet. By\nincluding the input value of part of the transaction digest, a cold\nwallet may safely sign a transaction by learning the value from an\nuntrusted source. In the case that a wrong value is provided and\nsigned, the signature would be invalid and no funding might be lost.\n[^5]')])]),e._v(" "),c("p",[e._v("Deploying the aforementioned fixes in the original script system is not\na simple task. That would be either a hardfork, or a softfork for new\nsigops without the ability to remove or insert stack items. However, the\nintroduction of segregated witness softfork offers an opportunity to\ndefine a different set of script semantics without disrupting the\noriginal system, as the unupgraded nodes would always consider such a\ntransaction output is spendable by arbitrary signature or no signature\nat all. [^6]")]),e._v(" "),c("h2",{attrs:{id:"specification"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#specification"}},[e._v("#")]),e._v(" Specification")]),e._v(" "),c("p",[e._v("A new transaction digest algorithm is defined, but only applicable to\nsigops in version 0 witness program:")]),e._v(" "),c("p",[c("code",[e._v("Double SHA256 of the serialization of:")]),c("br"),e._v(" "),c("code",[e._v("1. nVersion of the transaction (4-byte little endian)")]),c("br"),e._v(" "),c("code",[e._v("2. hashPrevouts (32-byte hash)")]),c("br"),e._v(" "),c("code",[e._v("3. hashSequence (32-byte hash)")]),c("br"),e._v(" "),c("code",[e._v("4. outpoint (32-byte hash + 4-byte little endian)")]),c("br"),e._v(" "),c("code",[e._v("5. scriptCode of the input (serialized as scripts inside CTxOuts)")]),c("br"),e._v(" "),c("code",[e._v("6. value of the output spent by this input (8-byte little endian)")]),c("br"),e._v(" "),c("code",[e._v("7. nSequence of the input (4-byte little endian)")]),c("br"),e._v(" "),c("code",[e._v("8. hashOutputs (32-byte hash)")]),c("br"),e._v(" "),c("code",[e._v("9. nLocktime of the transaction (4-byte little endian)")]),c("br"),e._v(" "),c("code",[e._v("10. sighash type of the signature (4-byte little endian)")])]),e._v(" "),c("p",[e._v("Semantics of the original sighash types remain unchanged, except the\nfollowings:")]),e._v(" "),c("ol",[c("li",[e._v("The way of serialization is changed;")]),e._v(" "),c("li",[e._v("All sighash types commit to the amount being spent by the signed\ninput;")]),e._v(" "),c("li",[c("code",[e._v("FindAndDelete")]),e._v(" of the signature is not applied to the "),c("code",[e._v("scriptCode")]),e._v(";")]),e._v(" "),c("li",[c("code",[e._v("OP_CODESEPARATOR")]),e._v("(s) after the last executed "),c("code",[e._v("OP_CODESEPARATOR")]),e._v(" are\nnot removed from the "),c("code",[e._v("scriptCode")]),e._v(" (the last executed\n"),c("code",[e._v("OP_CODESEPARATOR")]),e._v(" and any script before it are always removed);")]),e._v(" "),c("li",[c("code",[e._v("SINGLE")]),e._v(" does not commit to the input index. When "),c("code",[e._v("ANYONECANPAY")]),e._v(" is\nnot set, the semantics are unchanged since "),c("code",[e._v("hashPrevouts")]),e._v(" and\n"),c("code",[e._v("outpoint")]),e._v(" together implictly commit to the input index. When\n"),c("code",[e._v("SINGLE")]),e._v(" is used with "),c("code",[e._v("ANYONECANPAY")]),e._v(", omission of the index\ncommitment allows permutation of the input-output pairs, as long as\neach pair is located at an equivalent index.")])]),e._v(" "),c("p",[e._v("The items 1, 4, 7, 9, 10 have the same meaning as the original\nalgorithm. [^7]")]),e._v(" "),c("p",[e._v("The item 5:")]),e._v(" "),c("ul",[c("li",[e._v("For "),c("code",[e._v("P2WPKH")]),e._v(" witness program, the "),c("code",[e._v("scriptCode")]),e._v(" is\n"),c("code",[e._v("0x1976a914{20-byte-pubkey-hash}88ac")]),e._v(".")]),e._v(" "),c("li",[e._v("For "),c("code",[e._v("P2WSH")]),e._v(" witness program,\n"),c("ul",[c("li",[e._v("if the "),c("code",[e._v("witnessScript")]),e._v(" does not contain any "),c("code",[e._v("OP_CODESEPARATOR")]),e._v(",\nthe "),c("code",[e._v("scriptCode")]),e._v(" is the "),c("code",[e._v("witnessScript")]),e._v(" serialized as scripts\ninside "),c("code",[e._v("CTxOut")]),e._v(".")]),e._v(" "),c("li",[e._v("if the "),c("code",[e._v("witnessScript")]),e._v(" contains any "),c("code",[e._v("OP_CODESEPARATOR")]),e._v(", the\n"),c("code",[e._v("scriptCode")]),e._v(" is the "),c("code",[e._v("witnessScript")]),e._v(" but removing everything up\nto and including the last executed "),c("code",[e._v("OP_CODESEPARATOR")]),e._v(" before the\nsignature checking opcode being executed, serialized as scripts\ninside "),c("code",[e._v("CTxOut")]),e._v(". (The exact semantics is demonstrated in the\nexamples below)")])])])]),e._v(" "),c("p",[e._v("The item 6 is a 8-byte value of the amount of bitcoin spent in this\ninput.")]),e._v(" "),c("p",[c("code",[e._v("hashPrevouts")]),e._v(":")]),e._v(" "),c("ul",[c("li",[e._v("If the "),c("code",[e._v("ANYONECANPAY")]),e._v(" flag is not set, "),c("code",[e._v("hashPrevouts")]),e._v(" is the double\nSHA256 of the serialization of all input outpoints;")]),e._v(" "),c("li",[e._v("Otherwise, "),c("code",[e._v("hashPrevouts")]),e._v(" is a "),c("code",[e._v("uint256")]),e._v(" of "),c("code",[e._v("0x0000......0000")]),e._v(".")])]),e._v(" "),c("p",[c("code",[e._v("hashSequence")]),e._v(":")]),e._v(" "),c("ul",[c("li",[e._v("If none of the "),c("code",[e._v("ANYONECANPAY")]),e._v(", "),c("code",[e._v("SINGLE")]),e._v(", "),c("code",[e._v("NONE")]),e._v(" sighash type is set,\n"),c("code",[e._v("hashSequence")]),e._v(" is the double SHA256 of the serialization of\n"),c("code",[e._v("nSequence")]),e._v(" of all inputs;")]),e._v(" "),c("li",[e._v("Otherwise, "),c("code",[e._v("hashSequence")]),e._v(" is a "),c("code",[e._v("uint256")]),e._v(" of "),c("code",[e._v("0x0000......0000")]),e._v(".")])]),e._v(" "),c("p",[c("code",[e._v("hashOutputs")]),e._v(":")]),e._v(" "),c("ul",[c("li",[e._v("If the sighash type is neither "),c("code",[e._v("SINGLE")]),e._v(" nor "),c("code",[e._v("NONE")]),e._v(", "),c("code",[e._v("hashOutputs")]),e._v(" is\nthe double SHA256 of the serialization of all output amount (8-byte\nlittle endian) with "),c("code",[e._v("scriptPubKey")]),e._v(" (serialized as scripts inside\nCTxOuts);")]),e._v(" "),c("li",[e._v("If sighash type is "),c("code",[e._v("SINGLE")]),e._v(" and the input index is smaller than the\nnumber of outputs, "),c("code",[e._v("hashOutputs")]),e._v(" is the double SHA256 of the output\namount with "),c("code",[e._v("scriptPubKey")]),e._v(" of the same index as the input;")]),e._v(" "),c("li",[e._v("Otherwise, "),c("code",[e._v("hashOutputs")]),e._v(" is a "),c("code",[e._v("uint256")]),e._v(" of "),c("code",[e._v("0x0000......0000")]),e._v(".[^8]")])]),e._v(" "),c("p",[e._v("The "),c("code",[e._v("hashPrevouts")]),e._v(", "),c("code",[e._v("hashSequence")]),e._v(", and "),c("code",[e._v("hashOutputs")]),e._v(" calculated in an\nearlier verification may be reused in other inputs of the same\ntransaction, so that the time complexity of the whole hashing process\nreduces from O(n^2^) to O(n).")]),e._v(" "),c("p",[e._v("Refer to the reference implementation, reproduced below, for the precise\nalgorithm:")]),e._v(" "),c("div",{staticClass:"language-cpp line-numbers-mode"},[c("pre",{pre:!0,attrs:{class:"language-cpp"}},[c("code",[e._v("  uint256 hashPrevouts"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  uint256 hashSequence"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  uint256 hashOutputs"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  \n  "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("nHashType "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v(" SIGHASH_ANYONECANPAY"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      CHashWriter "),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("ss")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("SER_GETHASH"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("unsigned")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("int")]),e._v(" n "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" n "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vin"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("size")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" n"),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("++")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n          ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vin"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("n"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("prevout"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n      hashPrevouts "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" ss"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("GetHash")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  \n  "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("nHashType "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v(" SIGHASH_ANYONECANPAY"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("nHashType "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0x1f")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!=")]),e._v(" SIGHASH_SINGLE "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("nHashType "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0x1f")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!=")]),e._v(" SIGHASH_NONE"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      CHashWriter "),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("ss")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("SER_GETHASH"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("unsigned")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("int")]),e._v(" n "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" n "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vin"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("size")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" n"),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("++")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n          ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vin"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("n"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("nSequence"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n      hashSequence "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" ss"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("GetHash")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  \n  "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("nHashType "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0x1f")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!=")]),e._v(" SIGHASH_SINGLE "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("nHashType "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0x1f")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!=")]),e._v(" SIGHASH_NONE"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      CHashWriter "),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("ss")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("SER_GETHASH"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("unsigned")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("int")]),e._v(" n "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" n "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vout"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("size")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" n"),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("++")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n          ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vout"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("n"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n      hashOutputs "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" ss"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("GetHash")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("else")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("nHashType "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0x1f")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("==")]),e._v(" SIGHASH_SINGLE "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" nIn "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vout"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("size")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      CHashWriter "),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("ss")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("SER_GETHASH"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vout"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("nIn"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      hashOutputs "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" ss"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("GetHash")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  \n  CHashWriter "),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("ss")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("SER_GETHASH"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Version")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("nVersion"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Input prevouts/nSequence (none/all, depending on flags)")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" hashPrevouts"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" hashSequence"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// The input being signed (replacing the scriptSig with scriptCode + amount)")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// The prevout may already be contained in hashPrevout, and the nSequence")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// may already be contain in hashSequence.")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vin"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("nIn"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("prevout"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("static_cast")]),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" CScriptBase"),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("scriptCode"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" amount"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("vin"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("nIn"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("nSequence"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Outputs (none/one/all, depending on flags)")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" hashOutputs"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Locktime")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" txTo"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("nLockTime"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),c("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Sighash type")]),e._v("\n  ss "),c("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" nHashType"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  \n  "),c("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" ss"),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),c("span",{pre:!0,attrs:{class:"token function"}},[e._v("GetHash")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),c("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),e._v(" "),c("div",{staticClass:"line-numbers-wrapper"},[c("span",{staticClass:"line-number"},[e._v("1")]),c("br"),c("span",{staticClass:"line-number"},[e._v("2")]),c("br"),c("span",{staticClass:"line-number"},[e._v("3")]),c("br"),c("span",{staticClass:"line-number"},[e._v("4")]),c("br"),c("span",{staticClass:"line-number"},[e._v("5")]),c("br"),c("span",{staticClass:"line-number"},[e._v("6")]),c("br"),c("span",{staticClass:"line-number"},[e._v("7")]),c("br"),c("span",{staticClass:"line-number"},[e._v("8")]),c("br"),c("span",{staticClass:"line-number"},[e._v("9")]),c("br"),c("span",{staticClass:"line-number"},[e._v("10")]),c("br"),c("span",{staticClass:"line-number"},[e._v("11")]),c("br"),c("span",{staticClass:"line-number"},[e._v("12")]),c("br"),c("span",{staticClass:"line-number"},[e._v("13")]),c("br"),c("span",{staticClass:"line-number"},[e._v("14")]),c("br"),c("span",{staticClass:"line-number"},[e._v("15")]),c("br"),c("span",{staticClass:"line-number"},[e._v("16")]),c("br"),c("span",{staticClass:"line-number"},[e._v("17")]),c("br"),c("span",{staticClass:"line-number"},[e._v("18")]),c("br"),c("span",{staticClass:"line-number"},[e._v("19")]),c("br"),c("span",{staticClass:"line-number"},[e._v("20")]),c("br"),c("span",{staticClass:"line-number"},[e._v("21")]),c("br"),c("span",{staticClass:"line-number"},[e._v("22")]),c("br"),c("span",{staticClass:"line-number"},[e._v("23")]),c("br"),c("span",{staticClass:"line-number"},[e._v("24")]),c("br"),c("span",{staticClass:"line-number"},[e._v("25")]),c("br"),c("span",{staticClass:"line-number"},[e._v("26")]),c("br"),c("span",{staticClass:"line-number"},[e._v("27")]),c("br"),c("span",{staticClass:"line-number"},[e._v("28")]),c("br"),c("span",{staticClass:"line-number"},[e._v("29")]),c("br"),c("span",{staticClass:"line-number"},[e._v("30")]),c("br"),c("span",{staticClass:"line-number"},[e._v("31")]),c("br"),c("span",{staticClass:"line-number"},[e._v("32")]),c("br"),c("span",{staticClass:"line-number"},[e._v("33")]),c("br"),c("span",{staticClass:"line-number"},[e._v("34")]),c("br"),c("span",{staticClass:"line-number"},[e._v("35")]),c("br"),c("span",{staticClass:"line-number"},[e._v("36")]),c("br"),c("span",{staticClass:"line-number"},[e._v("37")]),c("br"),c("span",{staticClass:"line-number"},[e._v("38")]),c("br"),c("span",{staticClass:"line-number"},[e._v("39")]),c("br"),c("span",{staticClass:"line-number"},[e._v("40")]),c("br"),c("span",{staticClass:"line-number"},[e._v("41")]),c("br"),c("span",{staticClass:"line-number"},[e._v("42")]),c("br"),c("span",{staticClass:"line-number"},[e._v("43")]),c("br"),c("span",{staticClass:"line-number"},[e._v("44")]),c("br"),c("span",{staticClass:"line-number"},[e._v("45")]),c("br"),c("span",{staticClass:"line-number"},[e._v("46")]),c("br"),c("span",{staticClass:"line-number"},[e._v("47")]),c("br"),c("span",{staticClass:"line-number"},[e._v("48")]),c("br"),c("span",{staticClass:"line-number"},[e._v("49")]),c("br"),c("span",{staticClass:"line-number"},[e._v("50")]),c("br"),c("span",{staticClass:"line-number"},[e._v("51")]),c("br"),c("span",{staticClass:"line-number"},[e._v("52")]),c("br"),c("span",{staticClass:"line-number"},[e._v("53")]),c("br")])]),c("h2",{attrs:{id:"restrictions-on-public-key-type-restrictions-on-public-key-type"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#restrictions-on-public-key-type-restrictions-on-public-key-type"}},[e._v("#")]),e._v(" Restrictions on public key type {#restrictions_on_public_key_type}")]),e._v(" "),c("p",[e._v("As a default policy, only compressed public keys are accepted in\n"),c("code",[e._v("P2WPKH")]),e._v(" and "),c("code",[e._v("P2WSH")]),e._v(". Each public key passed to a sigop inside version 0\nwitness program must be a compressed key: the first byte MUST be either\n"),c("code",[e._v("0x02")]),e._v(" or "),c("code",[e._v("0x03")]),e._v(", and the size MUST be 33 bytes. Transactions that break\nthis rule will not be relayed or mined by default.")]),e._v(" "),c("p",[e._v("Since this policy is preparation for a future softfork proposal, to\navoid potential future funds loss, users MUST NOT use uncompressed keys\nin version 0 witness programs.")]),e._v(" "),c("h2",{attrs:{id:"example"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[e._v("#")]),e._v(" Example")]),e._v(" "),c("p",[e._v("To ensure consistency in consensus-critical behaviour, developers should\ntest their implementations against all the tests below. More tests\nrelated to this proposal could be found under\n"),c("a",{attrs:{href:"https://github.com/bitcoin/bitcoin/tree/master/src/test/data",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/bitcoin/bitcoin/tree/master/src/test/data"),c("OutboundLink")],1),e._v(" .")]),e._v(" "),c("h3",{attrs:{id:"native-p2wpkh-native-p2wpkh"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#native-p2wpkh-native-p2wpkh"}},[e._v("#")]),e._v(" Native P2WPKH {#native_p2wpkh}")]),e._v(" "),c("p",[c("code",[e._v("The following is an unsigned transaction:")]),c("br"),e._v(" "),c("code",[e._v("0100000002fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f0000000000eeffffffef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a0100000000ffffffff02202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac11000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("txin:      02 fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f 00000000 00 eeffffff")]),c("br"),e._v(" "),c("code",[e._v("ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a 01000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     02 202cb20600000000 1976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac")]),c("br"),e._v(" "),c("code",[e._v("9093510d00000000 1976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 11000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The first input comes from an ordinary P2PK:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey : 2103c9f4836b9a4f77fc0d81f7bcb01b7f1b35916864b9476c241ce9fc198bd25432ac value: 6.25")]),c("br"),e._v(" "),c("code",[e._v("private key  : bbc27228ddcb9209d7fd6f36b02f7dfa6252af40bb2f1cbc7a557da8027ff866")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The second input comes from a P2WPKH witness program:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey : 00141d0f172a0ecb48aee1be1f2687d2963ae33f71a1, value: 6")]),c("br"),e._v(" "),c("code",[e._v("private key  : 619c335025c7f4012e556c2a58b2506e30b8511b53ade95ea316fd8c3286feb9")]),c("br"),e._v(" "),c("code",[e._v("public key   : 025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee6357")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("To sign it with a nHashType of 1 (SIGHASH_ALL):")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashPrevouts:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f00000000ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a01000000)")]),c("br"),e._v(" "),c("code",[e._v("= 96b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd37")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashSequence:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(eeffffffffffffff)")]),c("br"),e._v(" "),c("code",[e._v("= 52b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3b")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashOutputs:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac)")]),c("br"),e._v(" "),c("code",[e._v("= 863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e5")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage: 0100000096b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd3752b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3bef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a010000001976a9141d0f172a0ecb48aee1be1f2687d2963ae33f71a188ac0046c32300000000ffffffff863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e51100000001000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: 96b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd37")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 52b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3b")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a01000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   1976a9141d0f172a0ecb48aee1be1f2687d2963ae33f71a188ac")]),c("br"),e._v(" "),c("code",[e._v("amount:       0046c32300000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e5")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    11000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    01000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("sigHash:      c37af31116d1b27caf68aae9e3ac82f1477929014d5b917657d0eb49478cb670")]),c("br"),e._v(" "),c("code",[e._v("signature:    304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The serialized signed transaction is: 01000000000102fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f00000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01eeffffffef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a0100000000ffffffff02202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac000247304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee0121025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee635711000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("marker:    00")]),c("br"),e._v(" "),c("code",[e._v("flag:      01")]),c("br"),e._v(" "),c("code",[e._v("txin:      02 fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f 00000000 494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01 eeffffff")]),c("br"),e._v(" "),c("code",[e._v("ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a 01000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     02 202cb20600000000 1976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac")]),c("br"),e._v(" "),c("code",[e._v("9093510d00000000 1976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac")]),c("br"),e._v(" "),c("code",[e._v("witness    00")]),c("br"),e._v(" "),c("code",[e._v("02 47304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee01 21025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee6357")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 11000000")])]),e._v(" "),c("h3",{attrs:{id:"p2sh-p2wpkh-p2sh-p2wpkh"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#p2sh-p2wpkh-p2sh-p2wpkh"}},[e._v("#")]),e._v(" P2SH-P2WPKH {#p2sh_p2wpkh}")]),e._v(" "),c("p",[c("code",[e._v("The following is an unsigned transaction: 0100000001db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a54770100000000feffffff02b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac92040000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("txin:      01 db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477 01000000 00 feffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     02 b8b4eb0b00000000 1976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac")]),c("br"),e._v(" "),c("code",[e._v("0008af2f00000000 1976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 92040000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The input comes from a P2SH-P2WPKH witness program:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey : a9144733f37cf4db86fbc2efed2500b4f4e49f31202387, value: 10")]),c("br"),e._v(" "),c("code",[e._v("redeemScript : 001479091972186c449eb1ded22b78e40d009bdf0089")]),c("br"),e._v(" "),c("code",[e._v("private key  : eb696a065ef48a2192da5b28b694f87544b30fae8327c4510137a922f32c6dcf")]),c("br"),e._v(" "),c("code",[e._v("public key   : 03ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a26873")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("To sign it with a nHashType of 1 (SIGHASH_ALL):")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashPrevouts:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a547701000000)")]),c("br"),e._v(" "),c("code",[e._v("= b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashSequence:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(feffffff)")]),c("br"),e._v(" "),c("code",[e._v("= 18606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashOutputs:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac)")]),c("br"),e._v(" "),c("code",[e._v("= de984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c83")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage: 01000000b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a18606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477010000001976a91479091972186c449eb1ded22b78e40d009bdf008988ac00ca9a3b00000000feffffffde984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c839204000001000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 18606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a547701000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   1976a91479091972186c449eb1ded22b78e40d009bdf008988ac")]),c("br"),e._v(" "),c("code",[e._v("amount:       00ca9a3b00000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    feffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  de984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c83")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    92040000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    01000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("sigHash:      64f3b0f4dd2bb3aa1ce8566d220cc74dda9df97d8490cc81d89d735c92e59fb6")]),c("br"),e._v(" "),c("code",[e._v("signature:    3044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb01")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The serialized signed transaction is: 01000000000101db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477010000001716001479091972186c449eb1ded22b78e40d009bdf0089feffffff02b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac02473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb012103ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a2687392040000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("marker:    00")]),c("br"),e._v(" "),c("code",[e._v("flag:      01")]),c("br"),e._v(" "),c("code",[e._v("txin:      01 db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477 01000000 1716001479091972186c449eb1ded22b78e40d009bdf0089 feffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     02 b8b4eb0b00000000 1976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac")]),c("br"),e._v(" "),c("code",[e._v("0008af2f00000000 1976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac")]),c("br"),e._v(" "),c("code",[e._v("witness    02 473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb01 2103ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a26873")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 92040000")])]),e._v(" "),c("h3",{attrs:{id:"native-p2wsh-native-p2wsh"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#native-p2wsh-native-p2wsh"}},[e._v("#")]),e._v(" Native P2WSH {#native_p2wsh}")]),e._v(" "),c("p",[e._v("This example shows how "),c("code",[e._v("OP_CODESEPARATOR")]),e._v(" and out-of-range\n"),c("code",[e._v("SIGHASH_SINGLE")]),e._v(" are processed:")]),e._v(" "),c("p",[c("code",[e._v("The following is an unsigned transaction:")]),c("br"),e._v(" "),c("code",[e._v("0100000002fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e0000000000ffffffff0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000000ffffffff0100f2052a010000001976a914a30741f8145e5acadf23f751864167f32e0963f788ac00000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("txin:      02 fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e 00000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f8 00000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     01 00f2052a01000000 1976a914a30741f8145e5acadf23f751864167f32e0963f788ac")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 00000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The first input comes from an ordinary P2PK:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey: 21036d5c20fa14fb2f635474c1dc4ef5909d4568e5569b79fc94d3448486e14685f8ac value: 1.5625")]),c("br"),e._v(" "),c("code",[e._v("private key:  b8f28a772fccbf9b4f58a4f027e07dc2e35e7cd80529975e292ea34f84c4580c")]),c("br"),e._v(" "),c("code",[e._v("signature:    304402200af4e47c9b9629dbecc21f73af989bdaa911f7e6f6c2e9394588a3aa68f81e9902204f3fcf6ade7e5abb1295b6774c8e0abd94ae62217367096bc02ee5e435b67da201 (SIGHASH_ALL)")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The second input comes from a native P2WSH witness program:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey : 00205d1b56b63d714eebe542309525f484b7e9d6f686b3781b6f61ef925d66d6f6a0, value: 49")]),c("br"),e._v(" "),c("code",[e._v("witnessScript: 21026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac")]),c("br"),e._v(" "),c("code",[e._v("<026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880ae> CHECKSIGVERIFY CODESEPARATOR <0255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465> CHECKSIG")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("To sign it with a nHashType of 3 (SIGHASH_SINGLE):")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashPrevouts:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f800000000)")]),c("br"),e._v(" "),c("code",[e._v("= ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d41")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d41")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f800000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   (see below)")]),c("br"),e._v(" "),c("code",[e._v("amount:       0011102401000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  0000000000000000000000000000000000000000000000000000000000000000 (this is the second input but there is only one output)")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    03000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("scriptCode:  4721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac")]),c("br"),e._v(" "),c("code",[e._v("^^")]),c("br"),e._v(" "),c("code",[e._v("(please note that the not-yet-executed OP_CODESEPARATOR is not removed from the scriptCode)")]),c("br"),e._v(" "),c("code",[e._v("preimage:    01000000ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d4100000000000000000000000000000000000000000000000000000000000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f8000000004721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac0011102401000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000003000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:     82dde6e4f1e94d02c2b7ad03d2115d691f48d064e9d52f58194a6637e4194391")]),c("br"),e._v(" "),c("code",[e._v("public key:  026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880ae")]),c("br"),e._v(" "),c("code",[e._v("private key: 8e02b539b1500aa7c81cf3fed177448a546f19d2be416c0c61ff28e577d8d0cd")]),c("br"),e._v(" "),c("code",[e._v("signature:   3044022027dc95ad6b740fe5129e7e62a75dd00f291a2aeb1200b84b09d9e3789406b6c002201a9ecd315dd6a0e632ab20bbb98948bc0c6fb204f2c286963bb48517a7058e2703")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("scriptCode:  23210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac")]),c("br"),e._v(" "),c("code",[e._v("(everything up to the last executed OP_CODESEPARATOR, including that OP_CODESEPARATOR, are removed)")]),c("br"),e._v(" "),c("code",[e._v("preimage:    01000000ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d4100000000000000000000000000000000000000000000000000000000000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000023210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac0011102401000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000003000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:     fef7bd749cce710c5c052bd796df1af0d935e59cea63736268bcbe2d2134fc47")]),c("br"),e._v(" "),c("code",[e._v("public key:  0255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465")]),c("br"),e._v(" "),c("code",[e._v("private key: 86bf2ed75935a0cbef03b89d72034bb4c189d381037a5ac121a70016db8896ec")]),c("br"),e._v(" "),c("code",[e._v("signature:   304402200de66acf4527789bfda55fc5459e214fa6083f936b430a762c629656216805ac0220396f550692cd347171cbc1ef1f51e15282e837bb2b30860dc77c8f78bc8501e503")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The serialized signed transaction is: 01000000000102fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e000000004847304402200af4e47c9b9629dbecc21f73af989bdaa911f7e6f6c2e9394588a3aa68f81e9902204f3fcf6ade7e5abb1295b6774c8e0abd94ae62217367096bc02ee5e435b67da201ffffffff0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000000ffffffff0100f2052a010000001976a914a30741f8145e5acadf23f751864167f32e0963f788ac000347304402200de66acf4527789bfda55fc5459e214fa6083f936b430a762c629656216805ac0220396f550692cd347171cbc1ef1f51e15282e837bb2b30860dc77c8f78bc8501e503473044022027dc95ad6b740fe5129e7e62a75dd00f291a2aeb1200b84b09d9e3789406b6c002201a9ecd315dd6a0e632ab20bbb98948bc0c6fb204f2c286963bb48517a7058e27034721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac00000000")])]),e._v(" "),c("p",[e._v("This example shows how unexecuted "),c("code",[e._v("OP_CODESEPARATOR")]),e._v(" is processed, and\n"),c("code",[e._v("SINGLE|ANYONECANPAY")]),e._v(" does not commit to the input index:")]),e._v(" "),c("p",[c("code",[e._v("The following is an unsigned transaction:")]),c("br"),e._v(" "),c("code",[e._v("0100000002e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffff0280969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac80969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac00000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("txin:      02 e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001 00000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b 00000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     02 8096980000000000 1976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac")]),c("br"),e._v(" "),c("code",[e._v("8096980000000000 1976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 00000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The first input comes from a native P2WSH witness program:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey: 0020ba468eea561b26301e4cf69fa34bde4ad60c81e70f059f045ca9a79931004a4d value: 0.16777215")]),c("br"),e._v(" "),c("code",[e._v("witnessScript:0063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac")]),c("br"),e._v(" "),c("code",[e._v("0 IF CODESEPARATOR ENDIF <0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98> CHECKSIG")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The second input comes from a native P2WSH witness program:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey: 0020d9bbfbe56af7c4b7f960a70d7ea107156913d9e5a26b0a71429df5e097ca6537 value: 0.16777215")]),c("br"),e._v(" "),c("code",[e._v("witnessScript:5163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac")]),c("br"),e._v(" "),c("code",[e._v("1 IF CODESEPARATOR ENDIF <0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98> CHECKSIG")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("To sign it with a nHashType of 0x83 (SINGLE|ANYONECANPAY):")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     (see below)")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   (see below)")]),c("br"),e._v(" "),c("code",[e._v("amount:       ffffff0000000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  (see below)")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    83000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("outpoint:    e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc00100000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:  270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac")]),c("br"),e._v(" "),c("code",[e._v("(since the OP_CODESEPARATOR is not executed, nothing is removed from the scriptCode)")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs: b258eaf08c39fbe9fbac97c15c7e7adeb8df142b0df6f83e017f349c2b6fe3d2")]),c("br"),e._v(" "),c("code",[e._v("preimage:    0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc00100000000270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98acffffff0000000000ffffffffb258eaf08c39fbe9fbac97c15c7e7adeb8df142b0df6f83e017f349c2b6fe3d20000000083000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:     e9071e75e25b8a1e298a72f0d2e9f4f95a0f5cdf86a533cda597eb402ed13b3a")]),c("br"),e._v(" "),c("code",[e._v("public key:  0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98")]),c("br"),e._v(" "),c("code",[e._v("private key: f52b3484edd96598e02a9c89c4492e9c1e2031f471c49fd721fe68b3ce37780d")]),c("br"),e._v(" "),c("code",[e._v("signature:   3045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("outpoint:    80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b00000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:  2468210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac")]),c("br"),e._v(" "),c("code",[e._v("(everything up to the last executed OP_CODESEPARATOR, including that OP_CODESEPARATOR, are removed)")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs: 91ea93dd77f702b738ebdbf3048940a98310e869a7bb8fa2c6cb3312916947ca")]),c("br"),e._v(" "),c("code",[e._v("preimage:    010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b000000002468210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98acffffff0000000000ffffffff91ea93dd77f702b738ebdbf3048940a98310e869a7bb8fa2c6cb3312916947ca0000000083000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:     cd72f1f1a433ee9df816857fad88d8ebd97e09a75cd481583eb841c330275e54")]),c("br"),e._v(" "),c("code",[e._v("public key:  0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98")]),c("br"),e._v(" "),c("code",[e._v("private key: f52b3484edd96598e02a9c89c4492e9c1e2031f471c49fd721fe68b3ce37780d")]),c("br"),e._v(" "),c("code",[e._v("signature:   30440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The serialized signed transaction is:")]),c("br"),e._v(" "),c("code",[e._v("01000000000102e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffff0280969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac80969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac02483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac024730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac00000000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("marker:    00")]),c("br"),e._v(" "),c("code",[e._v("flag:      01")]),c("br"),e._v(" "),c("code",[e._v("txin:      02 e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001 00000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b 00000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     02 8096980000000000 1976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac")]),c("br"),e._v(" "),c("code",[e._v("8096980000000000 1976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac")]),c("br"),e._v(" "),c("code",[e._v("witness    02 483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683 270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac")]),c("br"),e._v(" "),c("code",[e._v("02 4730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83 275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 00000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("Since SINGLE|ANYONECANPAY does not commit to the input index, the signatures are still valid when the input-output pairs are swapped:")]),c("br"),e._v(" "),c("code",[e._v("0100000000010280e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffffe9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff0280969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac80969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac024730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac02483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac00000000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("marker:    00")]),c("br"),e._v(" "),c("code",[e._v("flag:      01")]),c("br"),e._v(" "),c("code",[e._v("txin:      02 80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b 00000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001 00000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     02 8096980000000000 1976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac")]),c("br"),e._v(" "),c("code",[e._v("8096980000000000 1976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac")]),c("br"),e._v(" "),c("code",[e._v("witness    02 4730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83 275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac")]),c("br"),e._v(" "),c("code",[e._v("02 483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683 270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 00000000")])]),e._v(" "),c("h3",{attrs:{id:"p2sh-p2wsh-p2sh-p2wsh"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#p2sh-p2wsh-p2sh-p2wsh"}},[e._v("#")]),e._v(" P2SH-P2WSH {#p2sh_p2wsh}")]),e._v(" "),c("p",[e._v("This example is a P2SH-P2WSH 6-of-6 multisig witness program signed with\n6 different "),c("code",[e._v("SIGHASH")]),e._v(" types.")]),e._v(" "),c("p",[c("code",[e._v("The following is an unsigned transaction: 010000000136641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e0100000000ffffffff0200e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac00000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("txin:      01 36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e 01000000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     02 00e9a43500000000 1976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688ac")]),c("br"),e._v(" "),c("code",[e._v("c0832f0500000000 1976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 00000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The input comes from a P2SH-P2WSH 6-of-6 multisig witness program:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey : a9149993a429037b5d912407a71c252019287b8d27a587, value: 9.87654321")]),c("br"),e._v(" "),c("code",[e._v("redeemScript : 0020a16b5755f7f6f96dbd65f5f0d6ab9418b89af4b1f14a1bb8a09062c35f0dcb54")]),c("br"),e._v(" "),c("code",[e._v("witnessScript: 56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashPrevouts:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000)")]),c("br"),e._v(" "),c("code",[e._v("= 74afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashSequence:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(ffffffff)")]),c("br"),e._v(" "),c("code",[e._v("= 3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashOutputs for ALL:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(00e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac)")]),c("br"),e._v(" "),c("code",[e._v("= bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashOutputs for SINGLE:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(00e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688ac)")]),c("br"),e._v(" "),c("code",[e._v("= 9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage for ALL: 0100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa03bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e7066504436641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffffbc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc0000000001000000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: 74afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae")]),c("br"),e._v(" "),c("code",[e._v("amount:       b168de3a00000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    01000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:      185c0be5263dce5b4bb50a047973c1b6272bfbd0103a89444597dc40b248ee7c")]),c("br"),e._v(" "),c("code",[e._v("public key:   0307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba3")]),c("br"),e._v(" "),c("code",[e._v("private key:  730fff80e1413068a05b57d6a58261f07551163369787f349438ea38ca80fac6")]),c("br"),e._v(" "),c("code",[e._v("signature:    304402206ac44d672dac41f9b00e28f4df20c52eeb087207e8d758d76d92c6fab3b73e2b0220367750dbbe19290069cba53d096f44530e4f98acaa594810388cf7409a1870ce01")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage for NONE: 0100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000002000000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: 74afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae")]),c("br"),e._v(" "),c("code",[e._v("amount:       b168de3a00000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    02000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:        e9733bc60ea13c95c6527066bb975a2ff29a925e80aa14c213f686cbae5d2f36")]),c("br"),e._v(" "),c("code",[e._v("public key:     03b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b")]),c("br"),e._v(" "),c("code",[e._v("private key:    11fa3d25a17cbc22b29c44a484ba552b5a53149d106d3d853e22fdd05a2d8bb3")]),c("br"),e._v(" "),c("code",[e._v("signature:      3044022068c7946a43232757cbdf9176f009a928e1cd9a1a8c212f15c1e11ac9f2925d9002205b75f937ff2f9f3c1246e547e54f62e027f64eefa2695578cc6432cdabce271502")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage for SINGLE: 0100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f7080000000003000000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: 74afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae")]),c("br"),e._v(" "),c("code",[e._v("amount:       b168de3a00000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    03000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:        1e1f1c303dc025bd664acb72e583e933fae4cff9148bf78c157d1e8f78530aea")]),c("br"),e._v(" "),c("code",[e._v("public key:     034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a")]),c("br"),e._v(" "),c("code",[e._v("private key:    77bf4141a87d55bdd7f3cd0bdccf6e9e642935fec45f2f30047be7b799120661")]),c("br"),e._v(" "),c("code",[e._v("signature:      3044022059ebf56d98010a932cf8ecfec54c48e6139ed6adb0728c09cbe1e4fa0915302e022007cd986c8fa870ff5d2b3a89139c9fe7e499259875357e20fcbb15571c76795403")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage for ALL|ANYONECANPAY: 010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffffbc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc0000000081000000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae")]),c("br"),e._v(" "),c("code",[e._v("amount:       b168de3a00000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    81000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:        2a67f03e63a6a422125878b40b82da593be8d4efaafe88ee528af6e5a9955c6e")]),c("br"),e._v(" "),c("code",[e._v("public key:     033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f4")]),c("br"),e._v(" "),c("code",[e._v("private key:    14af36970f5025ea3e8b5542c0f8ebe7763e674838d08808896b63c3351ffe49")]),c("br"),e._v(" "),c("code",[e._v("signature:      3045022100fbefd94bd0a488d50b79102b5dad4ab6ced30c4069f1eaa69a4b5a763414067e02203156c6a5c9cf88f91265f5a942e96213afae16d83321c8b31bb342142a14d16381")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage for NONE|ANYONECANPAY: 010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000082000000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae")]),c("br"),e._v(" "),c("code",[e._v("amount:       b168de3a00000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    82000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:        781ba15f3779d5542ce8ecb5c18716733a5ee42a6f51488ec96154934e2c890a")]),c("br"),e._v(" "),c("code",[e._v("public key:     03a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac16")]),c("br"),e._v(" "),c("code",[e._v("private key:    fe9a95c19eef81dde2b95c1284ef39be497d128e2aa46916fb02d552485e0323")]),c("br"),e._v(" "),c("code",[e._v("signature:      3045022100a5263ea0553ba89221984bd7f0b13613db16e7a70c549a86de0cc0444141a407022005c360ef0ae5a5d4f9f2f87a56c1546cc8268cab08c73501d6b3be2e1e1a8a0882")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage for SINGLE|ANYONECANPAY: 010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f7080000000083000000")]),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 0000000000000000000000000000000000000000000000000000000000000000")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae")]),c("br"),e._v(" "),c("code",[e._v("amount:       b168de3a00000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    83000000")]),c("br"),e._v(" "),c("code",[e._v("sigHash:        511e8e52ed574121fc1b654970395502128263f62662e076dc6baf05c2e6a99b")]),c("br"),e._v(" "),c("code",[e._v("public key:     02d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b")]),c("br"),e._v(" "),c("code",[e._v("private key:    428a7aee9f0c2af0cd19af3cf1c78149951ea528726989b2e83e4778d2c3f890")]),c("br"),e._v(" "),c("code",[e._v("signature:      30440220525406a1482936d5a21888260dc165497a90a15669636d8edca6b9fe490d309c022032af0c646a34a44d1f4576bf6a4a74b67940f8faa84c7df9abe12a01a11e2b4783")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The serialized signed transaction is: 0100000000010136641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e0100000023220020a16b5755f7f6f96dbd65f5f0d6ab9418b89af4b1f14a1bb8a09062c35f0dcb54ffffffff0200e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac080047304402206ac44d672dac41f9b00e28f4df20c52eeb087207e8d758d76d92c6fab3b73e2b0220367750dbbe19290069cba53d096f44530e4f98acaa594810388cf7409a1870ce01473044022068c7946a43232757cbdf9176f009a928e1cd9a1a8c212f15c1e11ac9f2925d9002205b75f937ff2f9f3c1246e547e54f62e027f64eefa2695578cc6432cdabce271502473044022059ebf56d98010a932cf8ecfec54c48e6139ed6adb0728c09cbe1e4fa0915302e022007cd986c8fa870ff5d2b3a89139c9fe7e499259875357e20fcbb15571c76795403483045022100fbefd94bd0a488d50b79102b5dad4ab6ced30c4069f1eaa69a4b5a763414067e02203156c6a5c9cf88f91265f5a942e96213afae16d83321c8b31bb342142a14d16381483045022100a5263ea0553ba89221984bd7f0b13613db16e7a70c549a86de0cc0444141a407022005c360ef0ae5a5d4f9f2f87a56c1546cc8268cab08c73501d6b3be2e1e1a8a08824730440220525406a1482936d5a21888260dc165497a90a15669636d8edca6b9fe490d309c022032af0c646a34a44d1f4576bf6a4a74b67940f8faa84c7df9abe12a01a11e2b4783cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae00000000")])]),e._v(" "),c("h3",{attrs:{id:"no-findanddelete-no-findanddelete"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#no-findanddelete-no-findanddelete"}},[e._v("#")]),e._v(" No FindAndDelete {#no_findanddelete}")]),e._v(" "),c("p",[e._v("These examples show that "),c("code",[e._v("FindAndDelete")]),e._v(" for the signature is not\napplied. The transactions are generated in an unconventional way.\nInstead of signing using a private key, the signatures are\npre-determined as part of "),c("code",[e._v("witnessScript")]),e._v(". The public keys are generated\nwith key recovery, using the fixed signatures and the "),c("code",[e._v("sighash")]),e._v(" defined\nin this proposal. Therefore, the private keys are unknown.")]),e._v(" "),c("p",[c("code",[e._v("The following is an unsigned transaction: 010000000169c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d000000ffffffff0101000000000000000000000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("txin:      01 69c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f1 4c1d0000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     01 0100000000000000 00")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 00000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The input comes from a P2WSH witness program:")]),c("br"),e._v(" "),c("code",[e._v("scriptPubKey : 00209e1be07558ea5cc8e02ed1d80c0911048afad949affa36d5c3951e3159dbea19, value: 200000")]),c("br"),e._v(" "),c("code",[e._v("redeemScript : OP_CHECKSIGVERIFY <0x30450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01>")]),c("br"),e._v(" "),c("code",[e._v("ad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("To sign it with a nHashType of 1 (SIGHASH_ALL):")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashPrevouts:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(69c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d0000)")]),c("br"),e._v(" "),c("code",[e._v("= b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashSequence:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(ffffffff)")]),c("br"),e._v(" "),c("code",[e._v("= 3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hashOutputs:")]),c("br"),e._v(" "),c("code",[e._v("dSHA256(010000000000000000)")]),c("br"),e._v(" "),c("code",[e._v("= e5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b934228")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("hash preimage: 01000000b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e7066504469c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d00004aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01400d030000000000ffffffffe5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b9342280000000001000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("nVersion:     01000000")]),c("br"),e._v(" "),c("code",[e._v("hashPrevouts: b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f")]),c("br"),e._v(" "),c("code",[e._v("hashSequence: 3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044")]),c("br"),e._v(" "),c("code",[e._v("outpoint:     69c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d0000")]),c("br"),e._v(" "),c("code",[e._v("scriptCode:   4aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01")]),c("br"),e._v(" "),c("code",[e._v("amount:       400d030000000000")]),c("br"),e._v(" "),c("code",[e._v("nSequence:    ffffffff")]),c("br"),e._v(" "),c("code",[e._v("hashOutputs:  e5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b934228")]),c("br"),e._v(" "),c("code",[e._v("nLockTime:    00000000")]),c("br"),e._v(" "),c("code",[e._v("nHashType:    01000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("sigHash:      71c9cd9b2869b9c70b01b1f0360c148f42dee72297db312638df136f43311f23")]),c("br"),e._v(" "),c("code",[e._v("signature:    30450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e 01")]),c("br"),e._v(" "),c("code",[e._v("pubkey:       02a9781d66b61fb5a7ef00ac5ad5bc6ffc78be7b44a566e3c87870e1079368df4c")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("The serialized signed transaction is: 0100000000010169c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d000000ffffffff01010000000000000000034830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e012102a9781d66b61fb5a7ef00ac5ad5bc6ffc78be7b44a566e3c87870e1079368df4c4aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0100000000")])]),e._v(" "),c("p",[c("code",[e._v("nVersion:  01000000")]),c("br"),e._v(" "),c("code",[e._v("marker:    00")]),c("br"),e._v(" "),c("code",[e._v("flag:      01")]),c("br"),e._v(" "),c("code",[e._v("txin:      01 69c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f1 4c1d0000 00 ffffffff")]),c("br"),e._v(" "),c("code",[e._v("txout:     01 0100000000000000 00")]),c("br"),e._v(" "),c("code",[e._v("witness:   03 4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01")]),c("br"),e._v(" "),c("code",[e._v("2102a9781d66b61fb5a7ef00ac5ad5bc6ffc78be7b44a566e3c87870e1079368df4c")]),c("br"),e._v(" "),c("code",[e._v("4aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01")]),c("br"),e._v(" "),c("code",[e._v("nLockTime: 00000000")]),c("br"),e._v(" "),c("code")]),e._v(" "),c("p",[c("code",[e._v("The following transaction is a OP_CHECKMULTISIGVERIFY version of the FindAndDelete examples: 010000000001019275cb8d4a485ce95741c013f7c0d28722160008021bb469a11982d47a6628964c1d000000ffffffff0101000000000000000007004830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960101022102966f109c54e85d3aee8321301136cedeb9fc710fdef58a9de8a73942f8e567c021034ffc99dd9a79dd3cb31e2ab3e0b09e0e67db41ac068c625cd1f491576016c84e9552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c039596017500000000")]),c("br"),e._v(" "),c("code"),c("br"),e._v(" "),c("code",[e._v("redeemScript:  OP_2 OP_CHECKMULTISIGVERIFY <30450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01> <304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c03959601>")]),c("br"),e._v(" "),c("code",[e._v("hash preimage: 0100000039283953eb1e26994dde57b7f9362a79a8c523e2f8deba943c27e826a005f1e63bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e706650449275cb8d4a485ce95741c013f7c0d28722160008021bb469a11982d47a6628964c1d00009552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960175400d030000000000ffffffffe5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b9342280000000001000000")]),c("br"),e._v(" "),c("code",[e._v("sighash:       c1628a1e7c67f14ca0c27c06e4fdeec2e6d1a73c7a91d7c046ff83e835aebb72")]),c("br"),e._v(" "),c("code",[e._v("witness:       07 00")]),c("br"),e._v(" "),c("code",[e._v("4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01")]),c("br"),e._v(" "),c("code",[e._v("48304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c03959601")]),c("br"),e._v(" "),c("code",[e._v("0102")]),c("br"),e._v(" "),c("code",[e._v("2102966f109c54e85d3aee8321301136cedeb9fc710fdef58a9de8a73942f8e567c0")]),c("br"),e._v(" "),c("code",[e._v("21034ffc99dd9a79dd3cb31e2ab3e0b09e0e67db41ac068c625cd1f491576016c84e")]),c("br"),e._v(" "),c("code",[e._v("9552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960175")])]),e._v(" "),c("p",[e._v("The new serialization format is described in BIP144 [^9]")]),e._v(" "),c("h2",{attrs:{id:"deployment"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#deployment"}},[e._v("#")]),e._v(" Deployment")]),e._v(" "),c("p",[e._v("This proposal is deployed with Segregated Witness softfork (BIP 141)")]),e._v(" "),c("h2",{attrs:{id:"backward-compatibility-backward-compatibility"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#backward-compatibility-backward-compatibility"}},[e._v("#")]),e._v(" Backward compatibility {#backward_compatibility}")]),e._v(" "),c("p",[e._v("As a soft fork, older software will continue to operate without\nmodification. Non-upgraded nodes, however, will not see nor validate the\nwitness data and will consider all witness programs, including the\nredefined sigops, as anyone-can-spend scripts.")]),e._v(" "),c("h2",{attrs:{id:"reference-implementation-reference-implementation"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#reference-implementation-reference-implementation"}},[e._v("#")]),e._v(" Reference Implementation {#reference_implementation}")]),e._v(" "),c("p",[c("a",{attrs:{href:"https://github.com/bitcoin/bitcoin/pull/8149",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/bitcoin/bitcoin/pull/8149"),c("OutboundLink")],1)]),e._v(" "),c("h2",{attrs:{id:"references"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[e._v("#")]),e._v(" References")]),e._v(" "),c("div",{staticClass:"language- line-numbers-mode"},[c("pre",{pre:!0,attrs:{class:"language-text"}},[c("code",[e._v("<references />\n")])]),e._v(" "),c("div",{staticClass:"line-numbers-wrapper"},[c("span",{staticClass:"line-number"},[e._v("1")]),c("br")])]),c("h2",{attrs:{id:"copyright"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#copyright"}},[e._v("#")]),e._v(" Copyright")]),e._v(" "),c("p",[e._v("This document is placed in the public domain.")]),e._v(" "),c("p",[e._v("[^3]: "),c("a",{attrs:{href:"https://bitcointalk.org/?topic=140078",target:"_blank",rel:"noopener noreferrer"}},[e._v("New Bitcoin vulnerability: A transaction that takes at least 3\nminutes to verify"),c("OutboundLink")],1)]),e._v(" "),c("p",[e._v("[^4]: "),c("a",{attrs:{href:"http://rusty.ozlabs.org/?p=522",target:"_blank",rel:"noopener noreferrer"}},[e._v("The Megatransaction: Why Does It Take 25\nSeconds?"),c("OutboundLink")],1)]),e._v(" "),c("p",[e._v("[^5]: "),c("a",{attrs:{href:"https://bitcointalk.org/index.php?topic=181734.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("SIGHASH_WITHINPUTVALUE: Super-lightweight HW wallets and offline\ndata"),c("OutboundLink")],1)]),e._v(" "),c("p",[e._v("[^6]: "),c("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[e._v("BIP141: Segregated Witness (Consensus\nlayer)"),c("OutboundLink")],1)]),e._v(" "),c("p",[e._v("[^7]:")]),e._v(" "),c("p",[e._v("[^8]: In the original algorithm, a "),c("code",[e._v("uint256")]),e._v(" of "),c("code",[e._v("0x0000......0001")]),e._v(" is\ncommitted if the input index for a "),c("code",[e._v("SINGLE")]),e._v(" signature is greater\nthan or equal to the number of outputs. In this BIP a\n"),c("code",[e._v("0x0000......0000")]),e._v(" is committed, without changing the semantics.")]),e._v(" "),c("p",[e._v("[^9]: "),c("a",{attrs:{href:"bip-0144.mediawiki",title:"wikilink"}},[e._v("BIP144: Segregated Witness (Peer\nServices)")])])])}),[],!1,null,null,null);a.default=b.exports}}]);