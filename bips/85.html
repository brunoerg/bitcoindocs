<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>85 | Bitcoin Docs</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="apple-touch-icon" sizes="180x180" href="bitcoin.png">
    <link rel="icon" type="image/png" sizes="32x32" href="bitcoin.png">
    <link rel="icon" type="image/png" sizes="16x16" href="bitcoin.png">
    <link rel="mask-icon" href="bitcoin.png" color="#3a0839">
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="icon" href="bitcoin.png">
    <meta name="description" content="">
    <meta name="theme-color" content="#ff7e00">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/bitcoindocs/assets/css/0.styles.6b9516dd.css" as="style"><link rel="preload" href="/bitcoindocs/assets/js/app.c31d8641.js" as="script"><link rel="preload" href="/bitcoindocs/assets/js/2.b78a9106.js" as="script"><link rel="preload" href="/bitcoindocs/assets/js/119.65af5cbd.js" as="script"><link rel="prefetch" href="/bitcoindocs/assets/js/10.68a64a6d.js"><link rel="prefetch" href="/bitcoindocs/assets/js/100.bd554273.js"><link rel="prefetch" href="/bitcoindocs/assets/js/101.df38dcc3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/102.3bf2a9d4.js"><link rel="prefetch" href="/bitcoindocs/assets/js/103.d879654a.js"><link rel="prefetch" href="/bitcoindocs/assets/js/104.fcff9e3b.js"><link rel="prefetch" href="/bitcoindocs/assets/js/105.324f3006.js"><link rel="prefetch" href="/bitcoindocs/assets/js/106.b8b3ca20.js"><link rel="prefetch" href="/bitcoindocs/assets/js/107.4a9863c3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/108.e93a5196.js"><link rel="prefetch" href="/bitcoindocs/assets/js/109.e770824e.js"><link rel="prefetch" href="/bitcoindocs/assets/js/11.f67301bd.js"><link rel="prefetch" href="/bitcoindocs/assets/js/110.72ba2ba4.js"><link rel="prefetch" href="/bitcoindocs/assets/js/111.a33eb12f.js"><link rel="prefetch" href="/bitcoindocs/assets/js/112.ecf1c295.js"><link rel="prefetch" href="/bitcoindocs/assets/js/113.85f94e5b.js"><link rel="prefetch" href="/bitcoindocs/assets/js/114.c79655f2.js"><link rel="prefetch" href="/bitcoindocs/assets/js/115.3940b629.js"><link rel="prefetch" href="/bitcoindocs/assets/js/116.9ead4ccc.js"><link rel="prefetch" href="/bitcoindocs/assets/js/117.d4b75110.js"><link rel="prefetch" href="/bitcoindocs/assets/js/118.87575c0c.js"><link rel="prefetch" href="/bitcoindocs/assets/js/12.fc1e786f.js"><link rel="prefetch" href="/bitcoindocs/assets/js/120.99826b18.js"><link rel="prefetch" href="/bitcoindocs/assets/js/121.608c453c.js"><link rel="prefetch" href="/bitcoindocs/assets/js/122.b24765eb.js"><link rel="prefetch" href="/bitcoindocs/assets/js/123.64680142.js"><link rel="prefetch" href="/bitcoindocs/assets/js/124.4b4f9bc2.js"><link rel="prefetch" href="/bitcoindocs/assets/js/125.0e07a49d.js"><link rel="prefetch" href="/bitcoindocs/assets/js/126.be3bae0f.js"><link rel="prefetch" href="/bitcoindocs/assets/js/127.3d041c50.js"><link rel="prefetch" href="/bitcoindocs/assets/js/128.5feda1e3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/129.307399ad.js"><link rel="prefetch" href="/bitcoindocs/assets/js/13.47ba1b02.js"><link rel="prefetch" href="/bitcoindocs/assets/js/130.0659f005.js"><link rel="prefetch" href="/bitcoindocs/assets/js/131.69a612f3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/132.b51e17e2.js"><link rel="prefetch" href="/bitcoindocs/assets/js/133.7bb492d9.js"><link rel="prefetch" href="/bitcoindocs/assets/js/134.0f7e8787.js"><link rel="prefetch" href="/bitcoindocs/assets/js/135.e2504a16.js"><link rel="prefetch" href="/bitcoindocs/assets/js/136.8b6c7216.js"><link rel="prefetch" href="/bitcoindocs/assets/js/137.e38fc5b2.js"><link rel="prefetch" href="/bitcoindocs/assets/js/138.095843e4.js"><link rel="prefetch" href="/bitcoindocs/assets/js/139.4a5e77fb.js"><link rel="prefetch" href="/bitcoindocs/assets/js/14.42b93c7a.js"><link rel="prefetch" href="/bitcoindocs/assets/js/140.f517d934.js"><link rel="prefetch" href="/bitcoindocs/assets/js/141.7a6497c0.js"><link rel="prefetch" href="/bitcoindocs/assets/js/142.8ae1c029.js"><link rel="prefetch" href="/bitcoindocs/assets/js/143.2fadb8ac.js"><link rel="prefetch" href="/bitcoindocs/assets/js/144.a64d8f22.js"><link rel="prefetch" href="/bitcoindocs/assets/js/145.1b1fa851.js"><link rel="prefetch" href="/bitcoindocs/assets/js/146.a59efe37.js"><link rel="prefetch" href="/bitcoindocs/assets/js/147.a0a8fc92.js"><link rel="prefetch" href="/bitcoindocs/assets/js/148.e177254d.js"><link rel="prefetch" href="/bitcoindocs/assets/js/149.88223d18.js"><link rel="prefetch" href="/bitcoindocs/assets/js/15.cdd298ba.js"><link rel="prefetch" href="/bitcoindocs/assets/js/150.c07e2220.js"><link rel="prefetch" href="/bitcoindocs/assets/js/151.843c50f7.js"><link rel="prefetch" href="/bitcoindocs/assets/js/152.4f34674a.js"><link rel="prefetch" href="/bitcoindocs/assets/js/153.c2ba1434.js"><link rel="prefetch" href="/bitcoindocs/assets/js/154.dec4842c.js"><link rel="prefetch" href="/bitcoindocs/assets/js/155.ecd7b99f.js"><link rel="prefetch" href="/bitcoindocs/assets/js/156.55d078d3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/157.44501232.js"><link rel="prefetch" href="/bitcoindocs/assets/js/158.79220932.js"><link rel="prefetch" href="/bitcoindocs/assets/js/159.33765ed3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/16.4c7eeecf.js"><link rel="prefetch" href="/bitcoindocs/assets/js/160.ea470a70.js"><link rel="prefetch" href="/bitcoindocs/assets/js/161.2dc38d81.js"><link rel="prefetch" href="/bitcoindocs/assets/js/162.a27303c6.js"><link rel="prefetch" href="/bitcoindocs/assets/js/163.31e293c1.js"><link rel="prefetch" href="/bitcoindocs/assets/js/164.fca747d6.js"><link rel="prefetch" href="/bitcoindocs/assets/js/165.52456cdd.js"><link rel="prefetch" href="/bitcoindocs/assets/js/166.c2464f79.js"><link rel="prefetch" href="/bitcoindocs/assets/js/167.25467097.js"><link rel="prefetch" href="/bitcoindocs/assets/js/168.92664946.js"><link rel="prefetch" href="/bitcoindocs/assets/js/169.df73d115.js"><link rel="prefetch" href="/bitcoindocs/assets/js/17.b107683f.js"><link rel="prefetch" href="/bitcoindocs/assets/js/170.08fb6e7e.js"><link rel="prefetch" href="/bitcoindocs/assets/js/171.ba749017.js"><link rel="prefetch" href="/bitcoindocs/assets/js/172.c92581cb.js"><link rel="prefetch" href="/bitcoindocs/assets/js/173.1fce2c58.js"><link rel="prefetch" href="/bitcoindocs/assets/js/174.34c08943.js"><link rel="prefetch" href="/bitcoindocs/assets/js/175.0f3c7a0d.js"><link rel="prefetch" href="/bitcoindocs/assets/js/176.36c2e712.js"><link rel="prefetch" href="/bitcoindocs/assets/js/177.15027195.js"><link rel="prefetch" href="/bitcoindocs/assets/js/178.a42c47f3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/179.e9af4276.js"><link rel="prefetch" href="/bitcoindocs/assets/js/18.608ae665.js"><link rel="prefetch" href="/bitcoindocs/assets/js/180.48a51584.js"><link rel="prefetch" href="/bitcoindocs/assets/js/181.cc255bc5.js"><link rel="prefetch" href="/bitcoindocs/assets/js/182.64362e5e.js"><link rel="prefetch" href="/bitcoindocs/assets/js/183.256b3077.js"><link rel="prefetch" href="/bitcoindocs/assets/js/184.3139561e.js"><link rel="prefetch" href="/bitcoindocs/assets/js/185.5af948dd.js"><link rel="prefetch" href="/bitcoindocs/assets/js/19.8b76fc9c.js"><link rel="prefetch" href="/bitcoindocs/assets/js/20.122a4ef0.js"><link rel="prefetch" href="/bitcoindocs/assets/js/21.1f8a8820.js"><link rel="prefetch" href="/bitcoindocs/assets/js/22.eb68688b.js"><link rel="prefetch" href="/bitcoindocs/assets/js/23.9e751fd9.js"><link rel="prefetch" href="/bitcoindocs/assets/js/24.72ecb396.js"><link rel="prefetch" href="/bitcoindocs/assets/js/25.ad100f49.js"><link rel="prefetch" href="/bitcoindocs/assets/js/26.654fcf2f.js"><link rel="prefetch" href="/bitcoindocs/assets/js/27.fdb46ea9.js"><link rel="prefetch" href="/bitcoindocs/assets/js/28.b28d1103.js"><link rel="prefetch" href="/bitcoindocs/assets/js/29.979a7705.js"><link rel="prefetch" href="/bitcoindocs/assets/js/3.0ccb3eb1.js"><link rel="prefetch" href="/bitcoindocs/assets/js/30.27ab6b09.js"><link rel="prefetch" href="/bitcoindocs/assets/js/31.0b51055d.js"><link rel="prefetch" href="/bitcoindocs/assets/js/32.e5d3f476.js"><link rel="prefetch" href="/bitcoindocs/assets/js/33.5325af50.js"><link rel="prefetch" href="/bitcoindocs/assets/js/34.6cc1e8e6.js"><link rel="prefetch" href="/bitcoindocs/assets/js/35.4f93edf4.js"><link rel="prefetch" href="/bitcoindocs/assets/js/36.56c4b763.js"><link rel="prefetch" href="/bitcoindocs/assets/js/37.d7fc3cc3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/38.ba47e0be.js"><link rel="prefetch" href="/bitcoindocs/assets/js/39.a4948230.js"><link rel="prefetch" href="/bitcoindocs/assets/js/4.f750dbd8.js"><link rel="prefetch" href="/bitcoindocs/assets/js/40.13f04ebc.js"><link rel="prefetch" href="/bitcoindocs/assets/js/41.efba2874.js"><link rel="prefetch" href="/bitcoindocs/assets/js/42.71cd6fcf.js"><link rel="prefetch" href="/bitcoindocs/assets/js/43.3dd10508.js"><link rel="prefetch" href="/bitcoindocs/assets/js/44.0e0f5018.js"><link rel="prefetch" href="/bitcoindocs/assets/js/45.4e467a20.js"><link rel="prefetch" href="/bitcoindocs/assets/js/46.fbc682be.js"><link rel="prefetch" href="/bitcoindocs/assets/js/47.79e3cde6.js"><link rel="prefetch" href="/bitcoindocs/assets/js/48.36d1a4f2.js"><link rel="prefetch" href="/bitcoindocs/assets/js/49.5c861a4e.js"><link rel="prefetch" href="/bitcoindocs/assets/js/5.8f3d1a69.js"><link rel="prefetch" href="/bitcoindocs/assets/js/50.0c7609ac.js"><link rel="prefetch" href="/bitcoindocs/assets/js/51.6497b8ba.js"><link rel="prefetch" href="/bitcoindocs/assets/js/52.6fef223e.js"><link rel="prefetch" href="/bitcoindocs/assets/js/53.dc5dd169.js"><link rel="prefetch" href="/bitcoindocs/assets/js/54.560108ca.js"><link rel="prefetch" href="/bitcoindocs/assets/js/55.a09c65a8.js"><link rel="prefetch" href="/bitcoindocs/assets/js/56.f7f7c539.js"><link rel="prefetch" href="/bitcoindocs/assets/js/57.3b3dfb34.js"><link rel="prefetch" href="/bitcoindocs/assets/js/58.1048b51d.js"><link rel="prefetch" href="/bitcoindocs/assets/js/59.01f56552.js"><link rel="prefetch" href="/bitcoindocs/assets/js/6.ea542132.js"><link rel="prefetch" href="/bitcoindocs/assets/js/60.1e424058.js"><link rel="prefetch" href="/bitcoindocs/assets/js/61.6d4493b3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/62.849c30d7.js"><link rel="prefetch" href="/bitcoindocs/assets/js/63.0c6aaa64.js"><link rel="prefetch" href="/bitcoindocs/assets/js/64.0d99b925.js"><link rel="prefetch" href="/bitcoindocs/assets/js/65.d60db57e.js"><link rel="prefetch" href="/bitcoindocs/assets/js/66.c6c02735.js"><link rel="prefetch" href="/bitcoindocs/assets/js/67.c0c64c59.js"><link rel="prefetch" href="/bitcoindocs/assets/js/68.99f833eb.js"><link rel="prefetch" href="/bitcoindocs/assets/js/69.88769157.js"><link rel="prefetch" href="/bitcoindocs/assets/js/7.474d9a1c.js"><link rel="prefetch" href="/bitcoindocs/assets/js/70.0a746051.js"><link rel="prefetch" href="/bitcoindocs/assets/js/71.9847fc9b.js"><link rel="prefetch" href="/bitcoindocs/assets/js/72.8e04fa9b.js"><link rel="prefetch" href="/bitcoindocs/assets/js/73.772916a2.js"><link rel="prefetch" href="/bitcoindocs/assets/js/74.9663297b.js"><link rel="prefetch" href="/bitcoindocs/assets/js/75.66154da0.js"><link rel="prefetch" href="/bitcoindocs/assets/js/76.358626cf.js"><link rel="prefetch" href="/bitcoindocs/assets/js/77.8eafda69.js"><link rel="prefetch" href="/bitcoindocs/assets/js/78.782695f1.js"><link rel="prefetch" href="/bitcoindocs/assets/js/79.99523f6b.js"><link rel="prefetch" href="/bitcoindocs/assets/js/8.7a9d23a8.js"><link rel="prefetch" href="/bitcoindocs/assets/js/80.2c556ea8.js"><link rel="prefetch" href="/bitcoindocs/assets/js/81.b70d3d0d.js"><link rel="prefetch" href="/bitcoindocs/assets/js/82.f0c621cf.js"><link rel="prefetch" href="/bitcoindocs/assets/js/83.13117f68.js"><link rel="prefetch" href="/bitcoindocs/assets/js/84.2361b62a.js"><link rel="prefetch" href="/bitcoindocs/assets/js/85.e8f23ad0.js"><link rel="prefetch" href="/bitcoindocs/assets/js/86.eab303cd.js"><link rel="prefetch" href="/bitcoindocs/assets/js/87.a547f760.js"><link rel="prefetch" href="/bitcoindocs/assets/js/88.3c748686.js"><link rel="prefetch" href="/bitcoindocs/assets/js/89.6b7de962.js"><link rel="prefetch" href="/bitcoindocs/assets/js/9.6e1ca0bd.js"><link rel="prefetch" href="/bitcoindocs/assets/js/90.0907331e.js"><link rel="prefetch" href="/bitcoindocs/assets/js/91.fe47eeeb.js"><link rel="prefetch" href="/bitcoindocs/assets/js/92.f4c67fe3.js"><link rel="prefetch" href="/bitcoindocs/assets/js/93.efdc2e47.js"><link rel="prefetch" href="/bitcoindocs/assets/js/94.b7862723.js"><link rel="prefetch" href="/bitcoindocs/assets/js/95.06e410a5.js"><link rel="prefetch" href="/bitcoindocs/assets/js/96.0cc67031.js"><link rel="prefetch" href="/bitcoindocs/assets/js/97.b9460d90.js"><link rel="prefetch" href="/bitcoindocs/assets/js/98.0689894c.js"><link rel="prefetch" href="/bitcoindocs/assets/js/99.f18fe9ac.js">
    <link rel="stylesheet" href="/bitcoindocs/assets/css/0.styles.6b9516dd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bitcoindocs/" class="home-link router-link-active"><!----> <span class="site-name">Bitcoin Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/bitcoindocs/whitepaper/" class="nav-link">
  Whitepaper
</a></div><div class="nav-item"><a href="/bitcoindocs/releases/" class="nav-link">
  Releases
</a></div><div class="nav-item"><a href="/bitcoindocs/bips/" class="nav-link router-link-active">
  BIPs
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/bitcoindocs/whitepaper/" class="nav-link">
  Whitepaper
</a></div><div class="nav-item"><a href="/bitcoindocs/releases/" class="nav-link">
  Releases
</a></div><div class="nav-item"><a href="/bitcoindocs/bips/" class="nav-link router-link-active">
  BIPs
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>BIPs</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bitcoindocs/bips/" aria-current="page" class="sidebar-link">Bitcoin Improvement Proposals</a></li><li><a href="/bitcoindocs/bips/1.html" class="sidebar-link">1</a></li><li><a href="/bitcoindocs/bips/2.html" class="sidebar-link">2</a></li><li><a href="/bitcoindocs/bips/8.html" class="sidebar-link">8</a></li><li><a href="/bitcoindocs/bips/9.html" class="sidebar-link">9</a></li><li><a href="/bitcoindocs/bips/16.html" class="sidebar-link">16</a></li><li><a href="/bitcoindocs/bips/32.html" class="sidebar-link">32</a></li><li><a href="/bitcoindocs/bips/39.html" class="sidebar-link">39</a></li><li><a href="/bitcoindocs/bips/42.html" class="sidebar-link">42</a></li><li><a href="/bitcoindocs/bips/43.html" class="sidebar-link">43</a></li><li><a href="/bitcoindocs/bips/44.html" class="sidebar-link">44</a></li><li><a href="/bitcoindocs/bips/45.html" class="sidebar-link">45</a></li><li><a href="/bitcoindocs/bips/47.html" class="sidebar-link">47</a></li><li><a href="/bitcoindocs/bips/49.html" class="sidebar-link">49</a></li><li><a href="/bitcoindocs/bips/50.html" class="sidebar-link">50</a></li><li><a href="/bitcoindocs/bips/60.html" class="sidebar-link">60</a></li><li><a href="/bitcoindocs/bips/61.html" class="sidebar-link">61</a></li><li><a href="/bitcoindocs/bips/62.html" class="sidebar-link">62</a></li><li><a href="/bitcoindocs/bips/64.html" class="sidebar-link">64</a></li><li><a href="/bitcoindocs/bips/65.html" class="sidebar-link">65</a></li><li><a href="/bitcoindocs/bips/66.html" class="sidebar-link">66</a></li><li><a href="/bitcoindocs/bips/67.html" class="sidebar-link">67</a></li><li><a href="/bitcoindocs/bips/68.html" class="sidebar-link">68</a></li><li><a href="/bitcoindocs/bips/69.html" class="sidebar-link">69</a></li><li><a href="/bitcoindocs/bips/70.html" class="sidebar-link">70</a></li><li><a href="/bitcoindocs/bips/71.html" class="sidebar-link">71</a></li><li><a href="/bitcoindocs/bips/72.html" class="sidebar-link">72</a></li><li><a href="/bitcoindocs/bips/73.html" class="sidebar-link">73</a></li><li><a href="/bitcoindocs/bips/74.html" class="sidebar-link">74</a></li><li><a href="/bitcoindocs/bips/75.html" class="sidebar-link">75</a></li><li><a href="/bitcoindocs/bips/78.html" class="sidebar-link">78</a></li><li><a href="/bitcoindocs/bips/79.html" class="sidebar-link">79</a></li><li><a href="/bitcoindocs/bips/80.html" class="sidebar-link">80</a></li><li><a href="/bitcoindocs/bips/81.html" class="sidebar-link">81</a></li><li><a href="/bitcoindocs/bips/83.html" class="sidebar-link">83</a></li><li><a href="/bitcoindocs/bips/84.html" class="sidebar-link">84</a></li><li><a href="/bitcoindocs/bips/85.html" aria-current="page" class="active sidebar-link">85</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#abstract" class="sidebar-link">Abstract</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#definitions" class="sidebar-link">Definitions</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#motivation" class="sidebar-link">Motivation</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#specification" class="sidebar-link">Specification</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#reference-implementation-reference-implementation" class="sidebar-link">Reference Implementation {#reference_implementation}</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#applications" class="sidebar-link">Applications</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#backwards-compatibility-backwards-compatibility" class="sidebar-link">Backwards Compatibility {#backwards_compatibility}</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#discussion" class="sidebar-link">Discussion</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#acknowledgements" class="sidebar-link">Acknowledgements</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#references" class="sidebar-link">References</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#footnotes" class="sidebar-link">Footnotes</a></li><li class="sidebar-sub-header"><a href="/bitcoindocs/bips/85.html#copyright" class="sidebar-link">Copyright</a></li></ul></li><li><a href="/bitcoindocs/bips/90.html" class="sidebar-link">90</a></li><li><a href="/bitcoindocs/bips/91.html" class="sidebar-link">91</a></li><li><a href="/bitcoindocs/bips/98.html" class="sidebar-link">98</a></li><li><a href="/bitcoindocs/bips/99.html" class="sidebar-link">99</a></li><li><a href="/bitcoindocs/bips/100.html" class="sidebar-link">100</a></li><li><a href="/bitcoindocs/bips/101.html" class="sidebar-link">101</a></li><li><a href="/bitcoindocs/bips/102.html" class="sidebar-link">102</a></li><li><a href="/bitcoindocs/bips/103.html" class="sidebar-link">103</a></li><li><a href="/bitcoindocs/bips/104.html" class="sidebar-link">104</a></li><li><a href="/bitcoindocs/bips/105.html" class="sidebar-link">105</a></li><li><a href="/bitcoindocs/bips/106.html" class="sidebar-link">106</a></li><li><a href="/bitcoindocs/bips/107.html" class="sidebar-link">107</a></li><li><a href="/bitcoindocs/bips/109.html" class="sidebar-link">109</a></li><li><a href="/bitcoindocs/bips/111.html" class="sidebar-link">111</a></li><li><a href="/bitcoindocs/bips/112.html" class="sidebar-link">112</a></li><li><a href="/bitcoindocs/bips/113.html" class="sidebar-link">113</a></li><li><a href="/bitcoindocs/bips/114.html" class="sidebar-link">114</a></li><li><a href="/bitcoindocs/bips/115.html" class="sidebar-link">115</a></li><li><a href="/bitcoindocs/bips/116.html" class="sidebar-link">116</a></li><li><a href="/bitcoindocs/bips/117.html" class="sidebar-link">117</a></li><li><a href="/bitcoindocs/bips/118.html" class="sidebar-link">118</a></li><li><a href="/bitcoindocs/bips/119.html" class="sidebar-link">119</a></li><li><a href="/bitcoindocs/bips/120.html" class="sidebar-link">120</a></li><li><a href="/bitcoindocs/bips/121.html" class="sidebar-link">121</a></li><li><a href="/bitcoindocs/bips/122.html" class="sidebar-link">122</a></li><li><a href="/bitcoindocs/bips/123.html" class="sidebar-link">123</a></li><li><a href="/bitcoindocs/bips/124.html" class="sidebar-link">124</a></li><li><a href="/bitcoindocs/bips/125.html" class="sidebar-link">125</a></li><li><a href="/bitcoindocs/bips/126.html" class="sidebar-link">126</a></li><li><a href="/bitcoindocs/bips/127.html" class="sidebar-link">127</a></li><li><a href="/bitcoindocs/bips/130.html" class="sidebar-link">130</a></li><li><a href="/bitcoindocs/bips/131.html" class="sidebar-link">131</a></li><li><a href="/bitcoindocs/bips/132.html" class="sidebar-link">132</a></li><li><a href="/bitcoindocs/bips/133.html" class="sidebar-link">133</a></li><li><a href="/bitcoindocs/bips/134.html" class="sidebar-link">134</a></li><li><a href="/bitcoindocs/bips/135.html" class="sidebar-link">135</a></li><li><a href="/bitcoindocs/bips/136.html" class="sidebar-link">136</a></li><li><a href="/bitcoindocs/bips/137.html" class="sidebar-link">137</a></li><li><a href="/bitcoindocs/bips/140.html" class="sidebar-link">140</a></li><li><a href="/bitcoindocs/bips/141.html" class="sidebar-link">141</a></li><li><a href="/bitcoindocs/bips/142.html" class="sidebar-link">142</a></li><li><a href="/bitcoindocs/bips/143.html" class="sidebar-link">143</a></li><li><a href="/bitcoindocs/bips/144.html" class="sidebar-link">144</a></li><li><a href="/bitcoindocs/bips/145.html" class="sidebar-link">145</a></li><li><a href="/bitcoindocs/bips/146.html" class="sidebar-link">146</a></li><li><a href="/bitcoindocs/bips/147.html" class="sidebar-link">147</a></li><li><a href="/bitcoindocs/bips/148.html" class="sidebar-link">148</a></li><li><a href="/bitcoindocs/bips/149.html" class="sidebar-link">149</a></li><li><a href="/bitcoindocs/bips/150.html" class="sidebar-link">150</a></li><li><a href="/bitcoindocs/bips/151.html" class="sidebar-link">151</a></li><li><a href="/bitcoindocs/bips/152.html" class="sidebar-link">152</a></li><li><a href="/bitcoindocs/bips/154.html" class="sidebar-link">154</a></li><li><a href="/bitcoindocs/bips/155.html" class="sidebar-link">155</a></li><li><a href="/bitcoindocs/bips/156.html" class="sidebar-link">156</a></li><li><a href="/bitcoindocs/bips/157.html" class="sidebar-link">157</a></li><li><a href="/bitcoindocs/bips/158.html" class="sidebar-link">158</a></li><li><a href="/bitcoindocs/bips/159.html" class="sidebar-link">159</a></li><li><a href="/bitcoindocs/bips/171.html" class="sidebar-link">171</a></li><li><a href="/bitcoindocs/bips/173.html" class="sidebar-link">173</a></li><li><a href="/bitcoindocs/bips/174.html" class="sidebar-link">174</a></li><li><a href="/bitcoindocs/bips/175.html" class="sidebar-link">175</a></li><li><a href="/bitcoindocs/bips/176.html" class="sidebar-link">176</a></li><li><a href="/bitcoindocs/bips/178.html" class="sidebar-link">178</a></li><li><a href="/bitcoindocs/bips/179.html" class="sidebar-link">179</a></li><li><a href="/bitcoindocs/bips/180.html" class="sidebar-link">180</a></li><li><a href="/bitcoindocs/bips/197.html" class="sidebar-link">197</a></li><li><a href="/bitcoindocs/bips/199.html" class="sidebar-link">199</a></li><li><a href="/bitcoindocs/bips/300.html" class="sidebar-link">300</a></li><li><a href="/bitcoindocs/bips/301.html" class="sidebar-link">301</a></li><li><a href="/bitcoindocs/bips/310.html" class="sidebar-link">310</a></li><li><a href="/bitcoindocs/bips/320.html" class="sidebar-link">320</a></li><li><a href="/bitcoindocs/bips/322.html" class="sidebar-link">322</a></li><li><a href="/bitcoindocs/bips/325.html" class="sidebar-link">325</a></li><li><a href="/bitcoindocs/bips/339.html" class="sidebar-link">339</a></li><li><a href="/bitcoindocs/bips/340.html" class="sidebar-link">340</a></li><li><a href="/bitcoindocs/bips/341.html" class="sidebar-link">341</a></li><li><a href="/bitcoindocs/bips/342.html" class="sidebar-link">342</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_85"><a href="#_85" class="header-anchor">#</a> 85</h1> <div class="language- extra-class"><pre><code>  BIP: 85
  Layer: Applications
  Title: Deterministic Entropy From BIP32 Keychains
  Author: Ethan Kosakovsky &lt;ethankosakovsky@protonmail.com&gt;
  Comments-Summary: No comments yet.
  Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-0085
  Status: Draft
  Type: Informational
  Created: 2020-03-20
  License: BSD-2-Clause
           OPL
</code></pre></div><h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p><em>&quot;One Seed to rule them all,</em> <em>One Key to find them,</em> <em>One Path to
bring them all,</em> <em>And in cryptography bind them.&quot;</em></p> <p>It is not possible to maintain one single (mnemonic) seed backup for all
keychains used across various wallets because there are a variety of
incompatible standards. Sharing of seeds across multiple wallets is not
desirable for security reasons. Physical storage of multiple seeds is
difficult depending on the security and redundancy required.</p> <p>As HD keychains are essentially derived from initial entropy, this
proposal provides a way to derive entropy from the keychain which can be
fed into whatever method a wallet uses to derive the initial mnemonic
seed or root key.</p> <h2 id="definitions"><a href="#definitions" class="header-anchor">#</a> Definitions</h2> <p>The terminology related to keychains used in the wild varies widely, for
example `seed` has various different meanings. In this document we
define the terms</p> <ol><li><strong>BIP32 root key</strong> is the root extended private key that is
represented as the top root of the keychain in BIP32.</li> <li><strong>BIP39 mnemonic</strong> is the mnemonic phrase that is calculated from
the entropy used before hashing of the mnemonic in BIP39.</li> <li><strong>BIP39 seed</strong> is the result of hashing the BIP39 mnemonic seed.</li></ol> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <p>Most wallets implement BIP32 which defines how a BIP32 root key can be
used to derive keychains. As a consequence, a backup of just the BIP32
root key is sufficient to include all keys derived from it. BIP32 does
not have a human friendly serialization of the BIP32 root key (or BIP32
extended keys in general) which makes paper backups or manually
restoring the key more error-prone. BIP39 was designed solve this
problem but rather than serialize the BIP32 root key, it takes some
entropy, encoded to a &quot;seed mnemonic&quot;, which is then hashed to derive
the BIP39 seed which can be turned into the BIP32 root key. Saving the
BIP39 mnemonic is enough to reconstruct the entire BIP32 keychain, but a
BIP32 root key cannot be reversed back to the BIP39 mnemonic.</p> <p>Most wallets implement BIP39, so on initialization or restoration, the
user must interact with a BIP39 mnemonic. Most wallets do not support of
BIP32 extended private keys so each wallet must either share the same
BIP39 mnemonic, or have a separate BIP39 mnemonic entirely. Neither
scenarios are particularly satisfactory for security reasons. For
example, some wallets may be inherently less secure like hot wallets on
smartphones, Join Market servers, Lightning Network nodes. Having
multiple seeds is far from desirable especially for those who rely on
split key or redundancy backups in different geological locations.
Adding is necessarily difficult and may result in users being more lazy
with subsequent keys, such that compromises security or leads to key
loss.</p> <p>There is added complication with wallets that implement other standards,
or no standards at all. Bitcoin Core wallet uses a WIF as the <em>hdseed</em>,
and yet other wallets use different mnemonic schemes like Electrum to
derive the BIP32 root key. Other cryptocurrencies like Monero also use a
different mnemonic scheme entirely.</p> <p>Ultimately, all of the mnemonic/seed schemes start with some &quot;initial
entropy&quot; to derive a mnemonic/seed, and then process the mnemonic into
a BIP32 key, or private key. We can use BIP32 itself to derive the
&quot;initial entropy&quot; to then recreate the same mnemonic or seed according
the specific application standard of the target wallet. We can use a
BIP44 like categorization to ensure unitform derivation according to the
target application type.</p> <h2 id="specification"><a href="#specification" class="header-anchor">#</a> Specification</h2> <p>We assume a single BIP32 master root key. This specification is not
concerned with how this was derived (e.g. directly or via a mnemonic
scheme such as BIP39).</p> <p>For each application that requires its own wallet, a unique private key
is derived from the BIP32 master root key using fully hardened
derivation path. The resulting private key (k) is then processed with
HMAC-SHA512, where the key is &quot;bip-entropy-from-k&quot;, and the message
payload is the private key k:
<code>HMAC-SHA512(key=&quot;bip-entropy-from-k&quot;, msg=k)</code>. The result produces 512
bits of entropy. Each application SHOULD use up to the required number
of bits necessary for their operation truncating the rest</p> <p>The HMAC-SHA512 function is specified in <a href="http://tools.ietf.org/html/rfc4231" target="_blank" rel="noopener noreferrer">RFC
4231<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="test-vectors-test-vectors"><a href="#test-vectors-test-vectors" class="header-anchor">#</a> Test vectors {#test_vectors}</h3> <h4 id="test-case-1-test-case-1"><a href="#test-case-1-test-case-1" class="header-anchor">#</a> Test case 1 {#test_case_1}</h4> <p>INPUT:</p> <ul><li>MASTER BIP32 ROOT KEY:
xprv9s21ZrQH143K2LBWUUQRFXhucrQqBpKdRRxNVq2zBqsx8HVqFk2uYo8kmbaLLHRdqtQpUm98uKfu3vca1LqdGhUtyoFnCNkfmXRyPXLjbKb</li> <li>PATH: m/83696968'/0'/0'</li></ul> <p>OUTPUT:</p> <ul><li>DERIVED
KEY=cca20ccb0e9a90feb0912870c3323b24874b0ca3d8018c4b96d0b97c0e82ded0</li> <li>DERIVED
ENTROPY=efecfbccffea313214232d29e71563d941229afb4338c21f9517c41aaa0d16f00b83d2a09ef747e7a64e8e2bd5a14869e693da66ce94ac2da570ab7ee48618f7</li></ul> <h4 id="test-case-2-test-case-2"><a href="#test-case-2-test-case-2" class="header-anchor">#</a> Test case 2 {#test_case_2}</h4> <p>INPUT:</p> <ul><li>MASTER BIP32 ROOT KEY:
xprv9s21ZrQH143K2LBWUUQRFXhucrQqBpKdRRxNVq2zBqsx8HVqFk2uYo8kmbaLLHRdqtQpUm98uKfu3vca1LqdGhUtyoFnCNkfmXRyPXLjbKb</li> <li>PATH: m/83696968'/0'/1'</li></ul> <p>OUTPUT</p> <ul><li>DERIVED
KEY=503776919131758bb7de7beb6c0ae24894f4ec042c26032890c29359216e21ba</li> <li>DERIVED
ENTROPY=70c6e3e8ebee8dc4c0dbba66076819bb8c09672527c4277ca8729532ad711872218f826919f6b67218adde99018a6df9095ab2b58d803b5b93ec9802085a690e</li></ul> <h2 id="reference-implementation-reference-implementation"><a href="#reference-implementation-reference-implementation" class="header-anchor">#</a> Reference Implementation {#reference_implementation}</h2> <p>Python library implementation:
<a href="https://github.com/ethankosakovsky/bipentropy" target="_blank" rel="noopener noreferrer">python-bipentropy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="other-implementations-other-implementations"><a href="#other-implementations-other-implementations" class="header-anchor">#</a> Other Implementations {#other_implementations}</h3> <p>Coldcard Firmware: <a href="https://github.com/Coldcard/firmware/pull/39" target="_blank" rel="noopener noreferrer">1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="applications"><a href="#applications" class="header-anchor">#</a> Applications</h2> <p>Application number define how entropy will be used post processing. Some
basic examples follow:</p> <p>Derivation path uses the format <code>m/83696968/' + /app_no' + /index'</code>
where <em>app_no</em> path for the application, and `index` in the index.</p> <h3 id="bip39"><a href="#bip39" class="header-anchor">#</a> BIP39</h3> <p>Application number: 39'</p> <p>Truncate trailing (least significant) bytes of the entropy to the number
of bits required to map to the relevant word length 128 bits for 12
words, 256 bits for 24 words.</p> <p>The derivation path format is:
<code>m/83696968'/39'/{language}'/{words}'/{index}'</code></p> <p>Example a BIP39 mnemonic with 12 English words (first index) would have
the path <code>m/83696968'/39'/0'/12'/0'</code> the next key would be
<code>m/83696968'/39'/0'/12'/1'</code> etc.</p> <p>Language Table</p> <p>Wordlist                Code</p> <hr> <p>English                 0'
Japanese                1'
Korean                  2'
Spanish                 3'
Chinese (Simplified)    4'
Chinese (Traditional)   5'
French                  6'
Italian                 7'
Czech                   8'</p> <p>Words Table</p> <p>Words      Entropy    Code</p> <hr> <p>12 words   128 bits   12'
18 words   192 bits   18'
24 words   256 bits   24'</p> <h4 id="_12-english-words-english-words"><a href="#_12-english-words-english-words" class="header-anchor">#</a> 12 English words {#english_words}</h4> <p>BIP39 English 12 word mnemonic seed</p> <p>128 bits of entropy as input to BIP39 to derive 12 word mnemonic</p> <p>INPUT:</p> <ul><li>MASTER BIP32 ROOT KEY:
xprv9s21ZrQH143K2LBWUUQRFXhucrQqBpKdRRxNVq2zBqsx8HVqFk2uYo8kmbaLLHRdqtQpUm98uKfu3vca1LqdGhUtyoFnCNkfmXRyPXLjbKb</li> <li>PATH: m/83696968'/39'/0'/12'/0'</li></ul> <p>OUTPUT:</p> <ul><li>DERIVED ENTROPY=6250b68daf746d12a24d58b4787a714b</li> <li>DERIVED BIP39 MNEMONIC=girl mad pet galaxy egg matter matrix prison
refuse sense ordinary nose</li></ul> <h4 id="_18-english-words-english-words-1"><a href="#_18-english-words-english-words-1" class="header-anchor">#</a> 18 English words {#english_words_1}</h4> <p>BIP39 English 18 word mnemonic seed</p> <p>196 bits of entropy as input to BIP39 to derive 18 word mnemonic</p> <p>INPUT:</p> <ul><li>MASTER BIP32 ROOT KEY:
xprv9s21ZrQH143K2LBWUUQRFXhucrQqBpKdRRxNVq2zBqsx8HVqFk2uYo8kmbaLLHRdqtQpUm98uKfu3vca1LqdGhUtyoFnCNkfmXRyPXLjbKb</li> <li>PATH: m/83696968'/39'/0'/18'/0'</li></ul> <p>OUTPUT:</p> <ul><li>DERIVED ENTROPY=938033ed8b12698449d4bbca3c853c66b293ea1b1ce9d9dc</li> <li>DERIVED BIP39 MNEMONIC=near account window bike charge season chef
number sketch tomorrow excuse sniff circle vital hockey outdoor
supply token</li></ul> <h4 id="_24-english-words-english-words-2"><a href="#_24-english-words-english-words-2" class="header-anchor">#</a> 24 English words {#english_words_2}</h4> <p>Derives 24 word BIP39 mnemonic seed</p> <p>256 bits of entropy as input to BIP39 to derive 24 word mnemonic</p> <p>INPUT:</p> <ul><li>MASTER BIP32 ROOT KEY:
xprv9s21ZrQH143K2LBWUUQRFXhucrQqBpKdRRxNVq2zBqsx8HVqFk2uYo8kmbaLLHRdqtQpUm98uKfu3vca1LqdGhUtyoFnCNkfmXRyPXLjbKb</li> <li>PATH: m/83696968'/39'/0'/24'/0'</li></ul> <p>OUTPUT:</p> <ul><li>DERIVED
ENTROPY=ae131e2312cdc61331542efe0d1077bac5ea803adf24b313a4f0e48e9c51f37f</li> <li>DERIVED BIP39 MNEMONIC=puppy ocean match cereal symbol another shed
magic wrap hammer bulb intact gadget divorce twin tonight reason
outdoor destroy simple truth cigar social volcano</li></ul> <h3 id="hd-seed-wif-hd-seed-wif"><a href="#hd-seed-wif-hd-seed-wif" class="header-anchor">#</a> HD-Seed WIF {#hd_seed_wif}</h3> <p>Application number: 2'</p> <p>Uses 256 bits[1] of entropy as the secret exponent to derive a private
key and encode as a compressed WIF which will be used as the hdseed for
Bitcoin Core wallets.</p> <p>Path format is <code>m/83696968'/2'/{index}'</code></p> <p>INPUT:</p> <ul><li>MASTER BIP32 ROOT KEY:
xprv9s21ZrQH143K2LBWUUQRFXhucrQqBpKdRRxNVq2zBqsx8HVqFk2uYo8kmbaLLHRdqtQpUm98uKfu3vca1LqdGhUtyoFnCNkfmXRyPXLjbKb</li> <li>PATH: m/83696968'/2'/0'</li></ul> <p>OUTPUT</p> <ul><li>DERIVED
ENTROPY=7040bb53104f27367f317558e78a994ada7296c6fde36a364e5baf206e502bb1</li> <li>DERIVED WIF=Kzyv4uF39d4Jrw2W7UryTHwZr1zQVNk4dAFyqE6BuMrMh1Za7uhp</li></ul> <h3 id="xprv"><a href="#xprv" class="header-anchor">#</a> XPRV</h3> <p>Application number: 32'</p> <p>Taking 64 bytes of the HMAC digest, the first 32 bytes are the chain
code, and second 32 bytes[1] are the private key for BIP32 XPRV value.
Child number, depth, and parent fingerprint are forced to zero.</p> <p>Path format is <code>m/83696968'/32'/{index}'</code></p> <p>INPUT:</p> <ul><li>MASTER BIP32 ROOT KEY:
xprv9s21ZrQH143K2LBWUUQRFXhucrQqBpKdRRxNVq2zBqsx8HVqFk2uYo8kmbaLLHRdqtQpUm98uKfu3vca1LqdGhUtyoFnCNkfmXRyPXLjbKb</li> <li>PATH: m/83696968'/32'/0'</li></ul> <p>OUTPUT</p> <ul><li>DERIVED
ENTROPY=ead0b33988a616cf6a497f1c169d9e92562604e38305ccd3fc96f2252c177682</li> <li>DERIVED
WIF=xprv9s21ZrQH143K2srSbCSg4m4kLvPMzcWydgmKEnMmoZUurYuBuYG46c6P71UGXMzmriLzCCBvKQWBUv3vPB3m1SATMhp3uEjXHJ42jFg7myX</li></ul> <h3 id="hex"><a href="#hex" class="header-anchor">#</a> HEX</h3> <p>Application number: 128169'</p> <p>The derivation path format is:
<code>m/83696968'/128169'/{num_bytes}'/{index}'</code></p> <p>`16 &lt;= num_bytes &lt;= 64`</p> <p>Truncate trailing (least significant) bytes of the entropy after
`num_bytes`.</p> <p>INPUT:</p> <ul><li>MASTER BIP32 ROOT KEY:
xprv9s21ZrQH143K2LBWUUQRFXhucrQqBpKdRRxNVq2zBqsx8HVqFk2uYo8kmbaLLHRdqtQpUm98uKfu3vca1LqdGhUtyoFnCNkfmXRyPXLjbKb</li> <li>PATH: m/83696968'/128169'/64'/0'</li></ul> <p>OUTPUT</p> <ul><li>DERIVED
ENTROPY=492db4698cf3b73a5a24998aa3e9d7fa96275d85724a91e71aa2d645442f878555d078fd1f1f67e368976f04137b1f7a0d19232136ca50c44614af72b5582a5c</li></ul> <h2 id="backwards-compatibility-backwards-compatibility"><a href="#backwards-compatibility-backwards-compatibility" class="header-anchor">#</a> Backwards Compatibility {#backwards_compatibility}</h2> <p>This specification is not backwards compatible with any other existing
specification.</p> <p>This specification relies on BIP32 but is agnostic to how the BIP32 root
key is derived, as such this standard is allows it to derive wallets
with initialization schemes like BIP39 or Electrum wallet style
mnemonics.</p> <h2 id="discussion"><a href="#discussion" class="header-anchor">#</a> Discussion</h2> <p>The reason for running the derived key through HMAC-SHA512 and
truncating the result as necessary is to prevent leakage of the parent
tree should the derived key (k) be compromized. While the specification
requires the use of hardended key derivation which would prevent this,
we cannot enforce hardened derivation, so this method ensures the
derived entropy is hardened. Also from a semantic point of view, since
the purpose is to derive entropy and not a private key, we are required
to transform the child key. This acts in an abundance of caution to ward
off unwanted side effects should k be used for a dual purpose, including
as a nonce hash(k), where undesirable and unforeseen interactions could
occur.</p> <h2 id="acknowledgements"><a href="#acknowledgements" class="header-anchor">#</a> Acknowledgements</h2> <p>Many thanks to Peter Gray and Christopher Allen for their input, and to
Peter for suggesting extra application use cases.</p> <h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <p>BIP32, BIP39</p> <h2 id="footnotes"><a href="#footnotes" class="header-anchor">#</a> Footnotes</h2> <p>[1] There is a very small chance that you'll make an invalid key that
is zero or bigger than the order of the curve. If this occurs, software
should hard fail (forcing users should iterate to the next index).</p> <p>From BIP32: &gt; In case parse~256~(I~L~) is 0 or ≥ n, the resulting key
is invalid, and one should proceed with the next value for i. (Note:
this has probability lower than 1 in 2^127^.)</p> <h2 id="copyright"><a href="#copyright" class="header-anchor">#</a> Copyright</h2> <p>This BIP is dual-licensed under the Open Publication License and BSD
2-clause license.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/bitcoindocs/bips/84.html" class="prev">
        84
      </a></span> <span class="next"><a href="/bitcoindocs/bips/90.html">
        90
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/bitcoindocs/assets/js/app.c31d8641.js" defer></script><script src="/bitcoindocs/assets/js/2.b78a9106.js" defer></script><script src="/bitcoindocs/assets/js/119.65af5cbd.js" defer></script>
  </body>
</html>
